"use strict";(self.webpackChunkafd_experience_builder_doc=self.webpackChunkafd_experience_builder_doc||[]).push([[5593],{43895:function(e,t,a){a.r(t),a.d(t,{default:function(){return u}});var n=a(28453),i=a(96540);function r(e){const t=Object.assign({p:"p",h3:"h3",a:"a",span:"span",code:"code",pre:"pre"},(0,n.RP)(),e.components);return i.createElement(i.Fragment,null,i.createElement(t.p,null,"Many widgets in ArcGIS Experience Builder need to interact with the Map widget. For example, the Draw widget needs to draw graphics on the map, the Bookmark widget needs to connect to the map to work, etc.\nThis document describes how to use the Map widget in a widget."),"\n",i.createElement(t.h3,{id:"select-a-map-widget-in-the-widget-setting",className:"group relative s:flex s:flex-nowrap"},"Select a map widget in the widget setting",i.createElement(t.a,{href:"#select-a-map-widget-in-the-widget-setting","aria-label":"select a map widget in the widget setting permalink",className:"anchor-link"},i.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<calcite-icon scale="s" icon="link"></calcite-icon>'}}))),"\n",i.createElement(t.p,null,"To use the Map widget in the widget settings panel, you should use the ",i.createElement(t.a,{href:"https://developers.arcgis.com/experience-builder/storybook/?path=/docs/components-jimu-ui-advanced-setting-components-mapwidgetselector--docs"},i.createElement(t.code,null,"MapWidgetSelector"))," component."),"\n",i.createElement(t.pre,null,i.createElement(t.code,null,"import { MapWidgetSelector } from 'jimu-ui/advanced/setting-components'\n\n<MapWidgetSelector onSelect={onMapWidgetSelected} useMapWidgetIds={useMapWidgetIds} />\n")),"\n",i.createElement(t.p,null,"The ",i.createElement(t.code,null,"useMapWidgetIds")," property is an array of the map widget IDs that your widget is using. In the ",i.createElement(t.code,null,"onMapWidgetSelected")," callback function, you can get the selected map widget IDs.\nThis component will select the map widget in the same page automatically if there is only one map widget in the page."),"\n",i.createElement(t.p,null,"After selecting the map widget, if you need to select layers from the map widget, you can use the ",i.createElement(t.a,{href:"https://developers.arcgis.com/experience-builder/storybook/?path=/docs/components-jimu-ui-advanced-setting-components-jimulayerviewselector--docs"},i.createElement(t.code,null,"JimuLayerViewSelector"))," component."),"\n",i.createElement(t.pre,null,i.createElement(t.code,null,"import { JimuLayerViewSelector } from 'jimu-ui/advanced/setting-components'\n<JimuLayerViewSelector\n   jimuMapViewId={mapViewId}\n   onChange={onCustomizeLayerChange}\n   selectedValues={selectedValues}\n   ></JimuLayerViewSelector>\n")),"\n",i.createElement(t.p,null,"If the widget setting needs to use the modules from the ArcGIS Maps SDK for JavaScript, you must add ",i.createElement(t.code,null,'"settingDependency": ["jimu-arcgis"]')," in the widget's ",i.createElement(t.code,null,"manifest.json")," file. After that is added, you can import the modules like this: ",i.createElement(t.code,null,"import FeatureLayer from 'esri/layers/FeatureLayer'"),".\nIf you don't add the dependency, you must use ",i.createElement(t.code,null,"loadArcGISJSAPIModule()")," to load the modules from the ArcGIS Maps SDK for JavaScript dynamically."),"\n",i.createElement(t.h3,{id:"get-the-jimumapview-instance-in-the-widget",className:"group relative s:flex s:flex-nowrap"},"Get the JimuMapView instance in the widget",i.createElement(t.a,{href:"#get-the-jimumapview-instance-in-the-widget","aria-label":"get the jimumapview instance in the widget permalink",className:"anchor-link"},i.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<calcite-icon scale="s" icon="link"></calcite-icon>'}}))),"\n",i.createElement(t.p,null,"The ",i.createElement(t.a,{href:"https://developers.arcgis.com/experience-builder/api-reference/jimu-arcgis/JimuMapView/"},i.createElement(t.code,null,"JimuMapView"))," is a wrapper class of the ArcGIS Maps SDK for JavaScript ",i.createElement(t.a,{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-views-View.html"},i.createElement(t.code,null,"View")),". A Map widget can use multiple web maps or web scenes, so it can have multiple ",i.createElement(t.code,null,"JimuMapView")," instances, and users can switch between them.\nTo get the active ",i.createElement(t.code,null,"JimuMapView")," instance, you can use the ",i.createElement(t.a,{href:"https://developers.arcgis.com/experience-builder/api-reference/jimu-arcgis/JimuMapViewComponent/"},i.createElement(t.code,null,"JimuMapViewComponent")),"."),"\n",i.createElement(t.pre,null,i.createElement(t.code,null,"<JimuMapViewComponent useMapWidgetId={useMapWidgetId} onViewsCreate={onViewsCreate} onActiveViewChange={setJimuMapView} />\n")),"\n",i.createElement(t.p,null,"You can use ",i.createElement(t.code,null,"jimuMapView.view")," to get the ",i.createElement(t.code,null,"MapView")," or ",i.createElement(t.code,null,"SceneView")," instance."),"\n",i.createElement(t.p,null,"If the widget needs to use the modules from the ArcGIS Maps SDK for JavaScript, you must add ",i.createElement(t.code,null,'"dependency": ["jimu-arcgis"]')," in the widget's ",i.createElement(t.code,null,"manifest.json")," file. After that is added, you can import the modules like this: ",i.createElement(t.code,null,"import FeatureLayer from 'esri/layers/FeatureLayer'"),".\nIf you don't add the dependency, you must use ",i.createElement(t.code,null,"loadArcGISJSAPIModule()")," to load the modules from the ArcGIS Maps SDK for JavaScript dynamically."),"\n",i.createElement(t.h3,{id:"get-the-jimulayerviews-instances",className:"group relative s:flex s:flex-nowrap"},"Get the JimuLayerViews instances",i.createElement(t.a,{href:"#get-the-jimulayerviews-instances","aria-label":"get the jimulayerviews instances permalink",className:"anchor-link"},i.createElement(t.span,{dangerouslySetInnerHTML:{__html:'<calcite-icon scale="s" icon="link"></calcite-icon>'}}))),"\n",i.createElement(t.p,null,"To read the layers from the map widget, you can use the ",i.createElement(t.code,null,"jimuMapView.jimuLayerViews")," property. ",i.createElement(t.a,{href:"https://developers.arcgis.com/experience-builder/api-reference/jimu-arcgis/JimuLayerView/"},i.createElement(t.code,null,"JimuLayerView"))," is the wrapper class for ArcGIS Maps SDK for JavaScript ",i.createElement(t.a,{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-layers-Layer.html"},"Layer")," and ",i.createElement(t.a,{href:"https://developers.arcgis.com/javascript/latest/api-reference/esri-views-layers-LayerView.html"},i.createElement(t.code,null,"LayerView")),".\nYou can use the ",i.createElement(t.code,null,"jimuLayerView.layer")," and ",i.createElement(t.code,null,"jimuLayerView.view")," properties to get the ",i.createElement(t.code,null,"Layer")," and ",i.createElement(t.code,null,"LayerView")," instances. Please note the ",i.createElement(t.code,null,"jimuLayerView.layer")," may be a ",i.createElement(t.code,null,"Layer")," or a ",i.createElement(t.code,null,"SubLayer"),", and the ",i.createElement(t.code,null,"jimuLayerView.view")," may be null."),"\n",i.createElement(t.p,null,"You can use the ",i.createElement(t.code,null,"jimuLayerView.layerDataSourceId")," to get the data source id of the layer, use the ",i.createElement(t.code,null,"jimuLayerView.getLayerDataSource()")," to get the data source instance of the layer, and use the ",i.createElement(t.code,null,"jimuLayerView.createLayerDataSource()")," to create the data source if the data source is not created.\nHowever, please note not all layers are supported by data sources. If the layer has a data source instance, the ",i.createElement(t.code,null,"JimuLayerView")," will manage the synchronization between the layer and the data source, such as the selection, the filter, etc.\nThe selection synchronization is bidirectional, which means if you select a feature in the map, the selection will be synced to the data source, and if you select a record in the data source, the feature in the map will be highlighted.\nHowever, the filter synchronization is unidirectional, the filter in the data source will be synced to the layer, but the filter in the layer will not be synced to the data source."),"\n",i.createElement(t.pre,null,i.createElement(t.code,null,"// If you have a layer instance, use the below code to get the jimuLayerView instance\nconst jimuLayerView = jimuMapView.getJimuLayerViewByAPILayer(layerOrSubLayer);\n\n// If you have a jimulayerViewId, use the below code to get the jimuLayerView instance\nconst jimuLayerView = jimuMapView.jimuLayerViews[jimuLayerViewId];\n\n// If you need to get the data source instance of the layer\nconst dataSource = jimuLayerView.getLayerDataSource() || await jimuLayerView.createLayerDataSource();\n")))}var l=function(e){void 0===e&&(e={});const{wrapper:t}=Object.assign({},(0,n.RP)(),e.components);return t?i.createElement(t,e,i.createElement(r,e)):r(e)},c=a(69507),o=a(46427);const s=function(e){const{data:{topicNavigation:t}}=e;return i.createElement(c.A,null,i.createElement(o.S,Object.assign({},e,{topicNavigation:t,wrapInLayout:!1})))};function u(e){return i.createElement(s,e,i.createElement(l,e))}}}]);