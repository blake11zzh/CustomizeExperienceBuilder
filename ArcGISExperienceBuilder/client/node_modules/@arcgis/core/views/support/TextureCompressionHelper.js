/*
All material copyright ESRI, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
*/
import e from"../../core/Logger.js";import{destroyMaybe as r}from"../../core/maybe.js";import{whenOnce as t}from"../../core/reactiveUtils.js";import{makeScheduleFunction as n}from"../3d/layers/support/makeScheduleFunction.js";import{TextureCompressionWorkerHandle as o}from"../3d/webgl-engine/lib/TextureCompressionWorkerHandle.js";let i=null;const s=new Set,a=()=>e.getLogger("esri/views/support/TextureCompressionHelper");function m(){return i}function u(e,r){return i??=new o(n(r)),s.has(e)?a().warn("Repeated texture compression worker initialization by the same view."):s.add(e),i}function p(e){i&&(s.delete(e)||a().warn("Unknown view attempted to destroy the texture compression worker."),s.size||(r(i),i=null))}async function c(e){const r=e.basemapTerrain.renderer.test.tileRenderer;return t((()=>!r?.texturesBeingCompressed))}function l(e){return e instanceof HTMLImageElement||e instanceof HTMLCanvasElement}export{p as destroyTextureCompressionWorker,m as getTextureCompressionWorker,u as initializeTextureCompressionWorker,l as isCompressible,c as waitForTerrainTextureCompression};
