/*! All material copyright Esri, All Rights Reserved, unless otherwise specified.
See https://js.arcgis.com/4.32/esri/copyright.txt for details.
v4.32.1 */
import{a as D}from"./622JKFEM.js";import{a as M}from"./M3KD5LSY.js";import"./PJWJ6VO3.js";import"./OQ7XDNQ3.js";import"./SRQHJXGF.js";import"./GUY5ZCFS.js";import"./ZQ7NBMVX.js";import{e as y,f as p,g as F,i as S,j as x,k as R,m as g,n as u,o as V,p as E,q as v,r as $,s as L,w as P}from"./DE3BWTYY.js";import"./KTSGK4OT.js";import"./FBJBUUZK.js";import"./GBUMQPZY.js";var q=(a,i,t)=>{let d=new Map;for(let e=i;e<=t;e++)d.set(a[e],e);return d},_=x(class extends R{constructor(a){if(super(a),a.type!==S.CHILD)throw Error("repeat() can only be used in text expressions")}dt(a,i,t){let d;t===void 0?t=i:i!==void 0&&(d=i);let e=[],n=[],o=0;for(let m of a)e[o]=d?d(m,o):o,n[o]=t(m,o),o++;return{values:n,keys:e}}render(a,i,t){return this.dt(a,i,t).values}update(a,[i,t,d]){let e=E(a),{values:n,keys:o}=this.dt(i,t,d);if(!Array.isArray(e))return this.ut=o,n;let m=this.ut??=[],h=[],b,I,s=0,c=e.length-1,l=0,r=n.length-1;for(;s<=c&&l<=r;)if(e[s]===null)s++;else if(e[c]===null)c--;else if(m[s]===o[l])h[l]=u(e[s],n[l]),s++,l++;else if(m[c]===o[r])h[r]=u(e[c],n[r]),c--,r--;else if(m[s]===o[r])h[r]=u(e[s],n[r]),g(a,h[r+1],e[s]),s++,r--;else if(m[c]===o[l])h[l]=u(e[c],n[l]),g(a,e[s],e[c]),c--,l++;else if(b===void 0&&(b=q(o,l,r),I=q(m,s,c)),b.has(m[s]))if(b.has(m[c])){let f=I.get(o[l]),w=f!==void 0?e[f]:null;if(w===null){let k=g(a,e[s]);u(k,n[l]),h[l]=k}else h[l]=u(w,n[l]),g(a,e[s],w),e[f]=null;l++}else v(e[c]),c--;else v(e[s]),s++;for(;l<=r;){let f=g(a,h[r+1]);u(f,n[l]),h[l++]=f}for(;s<=c;){let f=e[s++];f!==null&&v(f)}return this.ut=o,V(a,h),F}});var A=y`:host{calcite-flow{height:100%}calcite-list-item-group{background-color:var(--calcite-color-foreground-2)}}`,C=class extends L{constructor(){super(...arguments),this.messages=D(),this._filterValue="",this._flowItemRenderers=[],this._mutationCounter=1,this.loading=!1,this.arcgisClose=$({bubbles:!1}),this.arcgisFieldSelected=$({bubbles:!1})}static{this.properties={_filterValue:16,_flowItemRenderers:16,_mutationCounter:16,loading:5,modelId:1}}static{this.styles=A}willUpdate(i){i.has("modelId")&&(this._flowItemRenderers=[])}disconnectedCallback(){super.disconnectedCallback(),this._flowObserver?.disconnect()}_handleSelectField(i){if(i.target instanceof HTMLElement)switch(i.target.tagName.toLowerCase()){case"calcite-list-item":{let t=i.target.value;this.arcgisFieldSelected.emit(t??"");break}case"calcite-action":i.stopPropagation();break}}_handleSelectDomain(i){let t=i.target.value;this.arcgisFieldSelected.emit(t?`'${t}'`:"")}_emitClose(){this.arcgisClose.emit()}render(){let i=M.getFeatureLayerForModel(this.modelId??"");return this.loading||!this.modelId||!i?p`<calcite-block .heading=${this.messages.availablefields??""}></calcite-block>`:p`<calcite-flow><calcite-flow-item .heading=${this.messages.availablefields??""} closable @calciteFlowItemClose=${this._emitClose}><calcite-list label=fields filter-enabled>${_(i.fields,t=>t.name,t=>p`<calcite-list-item @click=${this._handleSelectField} .label=${t.name} .description=${t.alias??""} .value=${t.name}>${t.domain&&p`<calcite-action slot=actions-end text=open icon=chevron-right @click=${()=>{let d=t.domain;d?.type==="coded-value"&&(this._flowItemRenderers=[...this._flowItemRenderers,()=>p`<calcite-flow-item closable .heading=${this.messages.domainvalues??""} .description=${t.name} @calciteFlowItemClose=${this._emitClose}><calcite-list label=domains>${_(d.codedValues,e=>e.code,e=>p`<calcite-list-item @click=${this._handleSelectDomain} .label=${e.name} .description=${String(e.code)} .value=${String(e.code)}></calcite-list-item>`)}</calcite-list></calcite-flow-item>`])}}></calcite-action>`||""}</calcite-list-item>`)}</calcite-list></calcite-flow-item>${this._flowItemRenderers.map(t=>t())}</calcite-flow>`}};P("arcgis-sql-expression-fields",C);export{C as SqlExpressionFields};
