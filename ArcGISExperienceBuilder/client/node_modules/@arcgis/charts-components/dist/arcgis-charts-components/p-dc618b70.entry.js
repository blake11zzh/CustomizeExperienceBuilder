/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See LICENSE.md for details.
 * v4.32.1
 */
import{r as t,c as i,g as s,h as e,H as a,a as r}from"./p-ccd1c88c.js";import{M as h,ah as c,C as n,ad as o,u as l,a5 as m,Z as d,r as g,L as p}from"./p-33adbadb.js";import{f,m as b,j as u,s as v,D as y,b as x}from"./p-13fd0548.js";import{b as C,f as w}from"./p-e3e7b132.js";import{d as k,s as z}from"./p-0a7e5e35.js";import{c as S}from"./p-bb01c887.js";import{i as j}from"./p-ff76a05d.js";import{t as P}from"./p-1383309b.js";import{W as $}from"./p-5a099bb2.js";import"./p-247471b0.js";import"./p-0f852d31.js";import"./p-76417cef.js";import"./p-d49d148b.js";import"./p-9333f322.js";import"./p-2d6b2c24.js";import"./p-a2f87a76.js";const E="label",I="number-input",M="icon-select",V="section-label",T="section-container",F="arcgis-charts-rtl",L=class{constructor(s){t(this,s),this.arcgisChartsConfigScatterPlotPopoverChange=i(this,"arcgisChartsConfigScatterPlotPopoverChange",7),this.arcgisChartsConfigPopoverOpenChange=i(this,"arcgisChartsConfigPopoverOpenChange",7),this.arcgisChartsConfigDataChangeError=i(this,"arcgisChartsConfigDataChangeError",7),this.scatterPlotPopover=null,this.items=[],this.setShowTrendLine=t=>{const i=t.target.checked;this.model.setShowLinearTrend(i),i||this.contentKind!==C.trendLine||this.closeScatterPlotPopover(t)},this.setTrendLineSymbol=t=>{this.model.setLinearTrendSymbol(S(t.detail))},this.symbolSizeChange=t=>{const i=t.target,{value:s}=i;if(void 0!==s&&f(s,i.min,i.max)){const t=Number.parseInt(s),e=this.model.getSizePolicy(),a=this.model.getFixedMarkerSymbol();switch(i.name){case"fixed-symbol-size":void 0!==a&&this.model.setFixedMarkerSymbol({...a,size:t});break;case"proportional-symbol-min-size":void 0!==e&&this.model.setSizePolicy({...e,minSize:t});break;case"proportional-symbol-max-size":void 0!==e&&this.model.setSizePolicy({...e,maxSize:t})}b({inputElement:i,status:x.IDLE})}else b({inputElement:i,status:x.INVALID})},this.symbolSizeRangeSliderInput=t=>{const i=t.target,{minValue:s,maxValue:e}=i,a=this.model.getSizePolicy();void 0!==a&&(this.model.setSizePolicy({...a,minSize:s,maxSize:e}),void 0!==this.minSizeInputElement&&(this.minSizeInputElement.value=`${s}`),void 0!==this.maxSizeInputElement&&(this.maxSizeInputElement.value=`${e}`))},this.changeColorTypeToggle=()=>{const t=this.colorModeElement?.selectedItem?.value;this.model.setColorMatch(t===this.strings.useLayerColors)},this.changeSymbolSizeTypeToggle=()=>{const t=this.symbolSizeModeElement?.value;this.selectedSizeType=t;const i=z.scatterPlotData[z.selectedChartId]?.sizePolicyField;t===w.Proportional&&void 0!==i?this.model.setSizePolicy({...this.model.getSizePolicy(),type:$.SizePolicy,field:i}):t===w.Fixed&&this.model.setSizePolicy({...this.model.getSizePolicy(),type:$.SizePolicy,field:""})},this.setFixedSymbolRGBAColor=t=>{const i=t.detail,[s,e,a]=i,r=255*p;this.model.setFixedMarkerSymbol({...this.model.getFixedMarkerSymbol(),color:[s,e,a,r]})},this.changeElementStyle=t=>{let i=t.target;"calcite-icon"===i.localName&&(i=i.parentElement),"selectColor"===i.value?(this.contentKind=C.symbol,this.selectedElement=this.model.getFixedMarkerSymbol()?.color):"selectTrendLine"===i.value&&(this.contentKind=C.trendLine,this.selectedElement=this.model.getLinearTrendSymbol())},this.onXVariableSelectChange=()=>{this.contentKind=C.xAxisField,this.selectedElement=this.model.getXAxisField()},this.onYVariableSelectChange=()=>{this.contentKind=C.yAxisField,this.selectedElement=this.model.getYAxisField()},this.onSizeVariableSelectChange=()=>{this.contentKind=C.sizeVariable,this.selectedElement=this.model.getSizePolicy()?.field??""},this.setXYField=async t=>{try{const i=t.detail;k(z),this.contentKind===C.xAxisField?await this.model.setXAxisField(i):await this.model.setYAxisField(i),this.removeScatterPlotPopover()}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}},this.setSizeVariableField=t=>{try{const i=t.detail;this.model.setSizePolicy(i?{...this.model.getSizePolicy(),type:$.SizePolicy,field:i}:void 0),z.scatterPlotData[z.selectedChartId]={...z.scatterPlotData[z.selectedChartId],sizePolicyField:this.model.getSizePolicy()?.field??void 0},this.removeScatterPlotPopover()}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}},this.closeScatterPlotPopover=t=>{this.scatterPlotPopover===t?.target&&(this.contentKind=C.none,this.removeScatterPlotPopover())},this.openChange=t=>{this.arcgisChartsConfigPopoverOpenChange.emit(t.detail)},this.onModelConfigChange=()=>{this.updatesOccurred=this.updatesOccurred+1;const{minSize:t,maxSize:i}=this.model.getSizePolicy()??{};void 0!==this.minSizeInputElement&&void 0!==t&&(this.minSizeInputElement.value=`${t}`,f(this.minSizeInputElement.value,this.minSizeInputElement.min,this.minSizeInputElement.max)?b({inputElement:this.minSizeInputElement,status:x.IDLE}):b({inputElement:this.minSizeInputElement,status:x.INVALID})),void 0!==this.maxSizeInputElement&&void 0!==i&&(this.maxSizeInputElement.value=`${i}`,f(this.maxSizeInputElement.value,this.maxSizeInputElement.min,this.maxSizeInputElement.max)?b({inputElement:this.maxSizeInputElement,status:x.IDLE}):b({inputElement:this.maxSizeInputElement,status:x.INVALID}))},this.model=void 0,this.r2=void 0,this.layerFieldsInfo=void 0,this.isTableLayer=void 0,this.open=!0,this.selectedElement=void 0,this.selectedSizeType=void 0,this.updatesOccurred=0}modelChange(t,i){i?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),t?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}openPopover(){"string"!=typeof this.selectedElement&&j(this.selectedElement)||this.setupScatterPlotPopover()}async componentWillLoad(){({strings:this.strings,direction:this.direction}=await h(this.hostElement,s("."))),this.modelChange(this.model),this.onModelConfigChange(),this.defaultR2Label=await c(),this.selectedSizeType=this.getCurrentSymbolSizeType(),this.selectedSizeType===w.Proportional&&(z.scatterPlotData[z.selectedChartId]={...z.scatterPlotData[z.selectedChartId],sizePolicyField:this.model.getSizePolicy()?.field})}disconnectedCallback(){this.removeScatterPlotPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}renderXVariable(){return e("arcgis-charts-config-field-select",{label:n(this.layerFieldsInfo,this.model.getXAxisField()??""),ref:t=>{this.xAxisElement=t},onClick:this.onXVariableSelectChange})}renderYVariable(){return e("arcgis-charts-config-field-select",{label:n(this.layerFieldsInfo,this.model.getYAxisField()??""),ref:t=>{this.yAxisElement=t},onClick:this.onYVariableSelectChange})}renderStatistics(){const[t,i,s,a]=[...this.model.getLinearTrendSymbol()?.color??o(0)];return e("div",{class:T},e("calcite-label",{class:E,layout:"inline-space-between"},this.strings.showLinearTrend,e("calcite-switch",{class:"switch-element",checked:this.model.getShowLinearTrend(),onCalciteSwitchChange:this.setShowTrendLine})),e("calcite-list",{label:"",selectionMode:"single",selectionAppearance:"border"},e("calcite-list-item",{label:this.strings.trendLineStyle,value:"selectTrendLine",hidden:!this.model.getShowLinearTrend(),selected:this.selectedElement?.type===l.SLS,ref:t=>{this.selectTrendLineElement=t},onClick:this.changeElementStyle},e("calcite-icon",{slot:"content-end",icon:"line-solid",style:{color:`rgba(${t},${i},${s},${a/255})`},class:M,onClick:this.changeElementStyle}))),e("div",{class:"r2",hidden:!this.model.getShowLinearTrend()},`${this.strings.r2}: ${Number.isNaN(this.r2)?this.defaultR2Label:u(this.r2,y)}`))}renderFixedSymbol(){return e("calcite-label",{class:E},this.strings.size,e("calcite-input",{type:"number",name:"fixed-symbol-size",class:I,min:1,max:100,step:1,value:v(this.model.getFixedMarkerSymbol()?.size),onCalciteInputInput:this.symbolSizeChange}))}async componentDidLoad(){await(async()=>{await new Promise((t=>setTimeout((()=>t()),250)))})(),this.items.forEach((t=>{delete t.focus}))}renderSizeVariable(){return e("arcgis-charts-config-field-select",{label:n(this.layerFieldsInfo,this.model.getSizePolicy()?.field??""),invalid:void 0===this.layerFieldsInfo.find((t=>t.name===this.model.getSizePolicy()?.field)),ref:t=>{this.sizeVariableElement=t},onClick:this.onSizeVariableSelectChange})}renderMinSizeInput(){return e("calcite-input",{type:"number",name:"proportional-symbol-min-size",class:I,min:1,max:this.model.getSizePolicy()?.maxSize??100,step:1,value:v(this.model.getSizePolicy()?.minSize),onCalciteInputInput:this.symbolSizeChange,ref:t=>{this.minSizeInputElement=t}})}renderMaxSizeInput(){return e("calcite-input",{type:"number",name:"proportional-symbol-max-size",class:I,min:this.model.getSizePolicy()?.minSize??1,max:100,step:1,value:v(this.model.getSizePolicy()?.maxSize),onCalciteInputInput:this.symbolSizeChange,ref:t=>{this.maxSizeInputElement=t}})}renderProportionalSymbol(){return e("div",{class:T},e("calcite-label",{class:E},this.strings.numberRequired,this.renderSizeVariable()),e("div",{class:"multi-input-section"},e("calcite-label",{class:E},this.strings.minSize,this.renderMinSizeInput()),e("calcite-label",{class:E},this.strings.maxSize,this.renderMaxSizeInput())),e("calcite-label",null,e("calcite-slider",{min:1,max:100,minValue:P(v(this.model.getSizePolicy()?.minSize)),maxValue:P(v(this.model.getSizePolicy()?.maxSize)),step:1,onCalciteSliderInput:this.symbolSizeRangeSliderInput})))}renderSymbolSizeType(){return e("calcite-label",{class:E},this.strings.size,e("calcite-segmented-control",{name:"symbolSizeType",layout:"horizontal",scale:"s",onCalciteSegmentedControlChange:this.changeSymbolSizeTypeToggle,ref:t=>{this.symbolSizeModeElement=t}},e("calcite-segmented-control-item",{value:w.Fixed,checked:w.Fixed===this.selectedSizeType,ref:t=>{t.focus=()=>{},this.items.push(t)}},this.strings.fixed),e("calcite-segmented-control-item",{value:w.Proportional,checked:w.Proportional===this.selectedSizeType,ref:t=>{t.focus=()=>{},this.items.push(t)}},this.strings.proportional)))}renderSymbol(){const[t,i,s,a]=[...this.model.getFixedMarkerSymbol()?.color??o(0)];return e("div",{class:T},this.renderSymbolSizeType(),this.selectedSizeType===w.Proportional?this.renderProportionalSymbol():this.renderFixedSymbol(),e("calcite-label",{class:E},this.strings.color,!0!==this.isTableLayer?e("calcite-segmented-control",{name:"layerColor",layout:"horizontal",scale:"s",onCalciteSegmentedControlChange:this.changeColorTypeToggle,ref:t=>{this.colorModeElement=t}},e("calcite-segmented-control-item",{value:this.strings.useLayerColors,checked:this.model.getColorMatch(),ref:t=>{t.focus=()=>{},this.items.push(t)}},this.strings.useLayerColors),e("calcite-segmented-control-item",{value:this.strings.singleColor,checked:!this.model.getColorMatch(),ref:t=>{t.focus=()=>{},this.items.push(t)}},this.strings.singleColor)):null),e("calcite-list",{label:"",selectionMode:"single",selectionAppearance:"border"},e("calcite-list-item",{label:this.strings.color,value:"selectColor",hidden:this.model.getColorMatch()&&!0!==this.isTableLayer,selected:Array.isArray(this.selectedElement),ref:t=>{this.selectColorElement=t},onClick:this.changeElementStyle},e("calcite-icon",{slot:"content-end",icon:"circle-f",style:{color:`rgba(${t},${i},${s},${a/255})`},class:M,onClick:this.changeElementStyle}))))}render(){return e(a,{key:"03f7f44733f9914b780dc1dc5f82f9a79438375e",class:{[F]:"rtl"===this.direction}},e("h3",{key:"dbfad812d143ff1f4d3cfd3ad1dadf9b31f26da4",class:V},this.strings.variables),e("calcite-label",{key:"59babdeb9d2a1c55416e0b5b9685e764446f7208",class:E},this.strings.xAxisNumber,this.renderXVariable()),e("calcite-label",{key:"75fd11346598c9fee68f4b8c5049950845afc826",class:E},this.strings.yAxisNumber,this.renderYVariable()),e("h3",{key:"6cbe9dba31d458f104e261814903bdb5f1824e66",class:V},this.strings.statistics),this.renderStatistics(),e("h3",{key:"4f60b0e15124a68050d18dd7588193ae7f9c5dda",class:V},this.strings.symbol),this.renderSymbol())}setupScatterPlotPopover(){switch(this.scatterPlotPopover=m(this.scatterPlotPopover),this.scatterPlotPopover=d(g.ScatterPlotDataPopover,{setTrendLineSymbol:this.setTrendLineSymbol,setFixedSymbolRGBAColor:this.setFixedSymbolRGBAColor,setXYField:this.setXYField,setSizeVariableField:this.setSizeVariableField,openChange:this.openChange,popoverClose:this.closeScatterPlotPopover}),this.scatterPlotPopover.layerFieldsInfo=[...this.layerFieldsInfo],this.scatterPlotPopover.contentKind=this.contentKind,this.contentKind){case C.xAxisField:this.scatterPlotPopover.referenceElement=this.xAxisElement,this.scatterPlotPopover.placement="trailing",this.scatterPlotPopover.selectedContent=this.model.getXAxisField(),this.scatterPlotPopover.headingTitle=this.strings.selectAField;break;case C.yAxisField:this.scatterPlotPopover.referenceElement=this.yAxisElement,this.scatterPlotPopover.placement="trailing",this.scatterPlotPopover.selectedContent=this.model.getYAxisField(),this.scatterPlotPopover.headingTitle=this.strings.selectAField;break;case C.sizeVariable:this.scatterPlotPopover.referenceElement=this.sizeVariableElement,this.scatterPlotPopover.placement="trailing",this.scatterPlotPopover.selectedContent=this.model.getSizePolicy()?.field??"",this.scatterPlotPopover.headingTitle=this.strings.selectAField;break;case C.symbol:case C.trendLine:{const t=this.selectedElement;this.scatterPlotPopover.selectedContent=this.selectedElement,this.scatterPlotPopover.placement="leading",Array.isArray(this.selectedElement)?this.scatterPlotPopover.referenceElement=this.selectColorElement:t?.type===l.SLS&&(this.scatterPlotPopover.referenceElement=this.selectTrendLineElement);break}default:this.contentKind=C.none,this.removeScatterPlotPopover()}this.contentKind!==C.none&&(this.scatterPlotPopover.open=!0,this.addScatterPlotPopover())}removeScatterPlotPopover(){null!==this.scatterPlotPopover&&(this.scatterPlotPopover=m(this.scatterPlotPopover)),this.selectedElement={}}addScatterPlotPopover(){document.body.contains(this.scatterPlotPopover)||null==this.scatterPlotPopover||document.body.appendChild(this.scatterPlotPopover)}getCurrentSymbolSizeType(){const t=this.model.getSizePolicy();return void 0===t||""===t.field?w.Fixed:w.Proportional}static get assetsDirs(){return["assets"]}get hostElement(){return r(this)}static get watchers(){return{model:["modelChange"],selectedElement:["openPopover"]}}};L.style=".hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0px;left:0px}.am5-modal-curtain{top:0px;left:0px;width:100%;height:100%;position:absolute;background:rgba(255, 255, 255, 0.5);z-index:100}.am5-modal-wrapper{top:0px;left:0px;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:rgba(255, 255, 255, 0.5);z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:left;white-space:normal;background:rgb(255, 255, 255);border-radius:4px;box-shadow:rgba(0, 0, 0, 0.45) 0px 0px 36px 0px;color:rgb(0, 0, 0)}.arcgis-charts-modal{box-shadow:none !important}.arcgis-charts-modal-header{background-color:rgba(0, 0, 0, 0.05);font-weight:bold;padding:4px 4px 4px 4px}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}:host .number-input{margin-bottom:0.5rem;display:flex}:host .number-input>div{width:100%}calcite-list-item{margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor)}calcite-slider{margin-top:-1.5rem}.r2{margin:var(--arcgis-charts-config-margin-major) var(--arcgis-charts-config-margin-minor)}.label{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);margin-right:var(--arcgis-charts-config-margin-minor);margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.text{display:flex;margin-left:var(--arcgis-charts-config-margin-minor);width:calc(100% - 1.5rem);height:2rem;margin-bottom:var(--arcgis-charts-config-margin-minor);justify-content:space-between}.section-container{display:flex;flex-direction:column}.icon-select{cursor:pointer}.section-label{display:flex;margin:var(--arcgis-charts-config-margin-major) var(--arcgis-charts-config-margin-minor);justify-content:space-between;align-items:center;font-weight:var(--calcite-font-weight-medium);font-size:var(--calcite-font-size-0)}.switch-element{margin-right:var(--arcgis-charts-config-margin-minor)}.multi-input-section{display:flex;justify-content:space-between;align-items:center}:host(.arcgis-charts-rtl) .text{margin-left:0rem;margin-right:var(--arcgis-charts-config-margin-minor)}:host(.arcgis-charts-rtl) .sub-header{margin-left:0rem;margin-right:var(--arcgis-charts-config-margin-minor)}:host(.arcgis-charts-rtl) .switch-element{margin-left:var(--arcgis-charts-config-margin-minor);margin-right:0rem}";export{L as arcgis_charts_config_scatter_plot_data}