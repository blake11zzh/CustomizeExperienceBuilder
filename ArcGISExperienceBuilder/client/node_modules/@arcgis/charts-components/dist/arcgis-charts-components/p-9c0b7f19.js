/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See LICENSE.md for details.
 * v4.32.1
 */
import{r as e,c as t,g as i,h as s,H as a,a as l}from"./p-ccd1c88c.js";import{M as n,y as c,N as o,A as r,_ as h,C as d,E as p,J as b,I as m}from"./p-33adbadb.js";import{L as f}from"./p-e3e7b132.js";import{e as u,a as g,U as y,i as x,s as k}from"./p-13fd0548.js";import{i as v}from"./p-7f5c1ec3.js";import{c as C,d as w}from"./p-5a099bb2.js";const L="pick-list-item-label",P=class{constructor(i){e(this,i),this.arcgisChartsConfigLineChartDataPopoverChange=t(this,"arcgisChartsConfigLineChartDataPopoverChange",7),this.arcgisChartsConfigLineChartPopoverClose=t(this,"arcgisChartsConfigLineChartPopoverClose",7),this.placement="leading",this.offsetDistance=-200,this.pickListHasChanged=!1,this.closePopover=()=>{this.contentKind===f.numericFields&&u({pickListElement:this.picklist,eventEmitter:this.arcgisChartsConfigLineChartDataPopoverChange,contentKind:this.contentKind}),this.open=!1,this.arcgisChartsConfigLineChartPopoverClose.emit(this.pickListHasChanged)},this.onDataContentTypeChange=e=>{this.pickListHasChanged=!0,this.arcgisChartsConfigLineChartDataPopoverChange.emit({contentKind:this.contentKind,value:e.target.selectedItems.map((e=>e.value))}),this.open=!1},this.intervalChange=()=>{const e=Number.parseInt(this.intervalSizeElement?.value??""),t=this.intervalTypeElement?.selectedOption?.value;!Number.isNaN(e)&&e>0&&this.arcgisChartsConfigLineChartDataPopoverChange.emit({contentKind:this.contentKind,value:[{intervalSize:e,intervalUnits:t}]}),this.open=!1},this.onNumericFieldsChange=e=>{null!==e.target&&(this.selectedContent=e.target.selectedItems.map((e=>e.value)))},this.onNumericFieldSelectionDone=()=>{this.pickListHasChanged&&this.closePopover()},this.headingTitle=void 0,this.referenceElement=void 0,this.open=void 0,this.contentKind=void 0,this.layerFieldsInfo=void 0,this.selectedContent=void 0}selectedContentChange(e,t){this.pickListHasChanged=!v(e,t)}async reposition(){await(this.popoverElement?.reposition())}async componentWillLoad(){({strings:this.strings}=await n(this.hostElement,i(".")))}async componentWillRender(){const e=g.map((async e=>await c(e)));this.aggregationLabels=await Promise.all(e);const t=[C.Start,C.End].map((async e=>await o(e)));this.timeAggregationLabels=await Promise.all(t)}componentDidRender(){setTimeout((async()=>{"function"==typeof this.picklist?.setFocus&&await(this.picklist?.setFocus())}),y.PopoverTimer),r(this.popoverElement,this.open)}componentDidUpdate(){setTimeout((()=>{this.popoverElement?.reposition()}),y.PopoverTimer)}renderAggregationType(){const e=this.buildAggregationPickListItems();return s("calcite-list",{label:"",class:L,selectionMode:"single",selectionAppearance:"border",filterEnabled:!1,onCalciteListChange:this.onDataContentTypeChange},e)}buildAggregationPickListItems(){return g.map(((e,t)=>s("calcite-list-item",{label:this.aggregationLabels[t],key:e,value:e,selected:x(e,this.selectedContent)})))}renderXAxisField(){const e=this.buildPickListItems(f.xAxisField);return s("calcite-list",{label:"",class:L,selectionMode:"single",selectionAppearance:"border",filterEnabled:!0,onCalciteListChange:this.onDataContentTypeChange,ref:e=>{this.picklist=e}},e)}renderNumericFields(){const e=this.buildPickListItems(f.numericFields);return s("calcite-list",{label:"",class:"line-chart-data-numeric-fields-pick-list",selectionMode:"multiple",filterEnabled:!0,onCalciteListChange:this.onNumericFieldsChange,ref:e=>{this.picklist=e}},e)}renderSplitByField(){const e=this.buildPickListItems(f.splitByField);return s("calcite-list",{label:"",class:L,selectionMode:"single",selectionAppearance:"border",filterEnabled:!0,onCalciteListChange:this.onDataContentTypeChange,ref:e=>{this.picklist=e}},e)}renderIntervalAlignment(){const e=this.buildIntervalAlignmentPickListItems();return s("calcite-list",{label:"",class:L,selectionMode:"single",selectionAppearance:"border",filterEnabled:!1,onCalciteListChange:this.onDataContentTypeChange},e)}renderInterval(){const e=this.selectedContent,t=[w.Seconds,w.Minutes,w.Hours,w.Days,w.Weeks,w.Months,w.Years];return s("div",null,s("div",{class:"size-section"},s("calcite-label",{scale:"m"},this.strings.intervalSize,s("calcite-input",{type:"number",scale:"m",min:1,step:"any",value:k(e?.timeIntervalSize,1),ref:e=>{this.intervalSizeElement=e}})),s("calcite-label",{scale:"m"},this.strings.intervalType,s("calcite-select",{label:this.strings.intervalType,ref:e=>{this.intervalTypeElement=e}},t.map((t=>s("calcite-option",{value:t,label:h(t,this.strings),selected:e?.timeIntervalUnits===t}))))),s("calcite-button",{class:"apply-button",appearance:"outline",onClick:this.intervalChange},this.strings.apply)))}buildIntervalAlignmentPickListItems(){return[C.Start,C.End].map(((e,t)=>s("calcite-list-item",{label:this.timeAggregationLabels[t],key:e,value:e,selected:x(e,this.selectedContent)})))}buildPickListItem(e){return s("calcite-list-item",{key:e.name,label:d(this.layerFieldsInfo,e.name),value:e.name,selected:x(e.name,this.selectedContent)})}buildPickListItems(e){const t=this.layerFieldsInfo?.length??0,i=[];switch(e){case f.numericFields:for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];m(t)&&i.push(this.buildPickListItem(t))}break;case f.xAxisField:for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];(m(t)||t.type===b.Date)&&i.push(this.buildPickListItem(t))}break;case f.splitByField:i.push(s("calcite-list-item",{label:" ",key:" ",value:" ",selected:x("",this.selectedContent)}));for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];(p(t)||t.type===b.String)&&i.push(this.buildPickListItem(t))}}return i}renderPopoverInfo(){let e;switch(this.contentKind){case f.aggregation:e=this.renderAggregationType();break;case f.xAxisField:e=this.renderXAxisField();break;case f.numericFields:e=this.renderNumericFields();break;case f.splitByField:e=this.renderSplitByField();break;case f.intervalAlignment:e=this.renderIntervalAlignment();break;case f.interval:e=this.renderInterval()}return e}render(){let e;return this.contentKind===f.numericFields&&(e=s("div",{key:"17c7c5f289350e3670c8d0c469ff33bbc5efacd9",slot:"footer"},s("calcite-fab",{key:"ee8dce86161de64488c24068a45bb811efec43fd",class:"fab",appearance:"outline-fill",kind:"neutral",icon:"",label:this.strings.selectionDone,scale:"s","text-enabled":!0,text:this.strings.selectionDone,onClick:this.onNumericFieldSelectionDone}))),s(a,{key:"4bebc3c07023e0476ecdf6d65ea4ced497e902ef",class:"js-app-flyout"},s("calcite-popover",{key:"2f392573289924c3d058e00d5f0b072d98852fff",class:"line-chart-data-popover",referenceElement:this.referenceElement,placement:this.placement,offsetDistance:this.offsetDistance,onCalcitePopoverClose:this.closePopover,open:this.open,label:"",ref:e=>{this.popoverElement=e}},s("calcite-panel",{key:"d2dcd7cae97f969a61fbe2006aedf69374d3611a",closable:!0,closed:!this.open,onCalcitePanelClose:this.closePopover},s("div",{key:"044b4117611319a8bb869dce168e0b0d4a02205a",slot:"header-content",class:"header"},this.headingTitle??""),this.renderPopoverInfo(),e)))}static get assetsDirs(){return["assets"]}get hostElement(){return l(this)}static get watchers(){return{selectedContent:["selectedContentChange"]}}};P.style=".hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0px;left:0px}.am5-modal-curtain{top:0px;left:0px;width:100%;height:100%;position:absolute;background:rgba(255, 255, 255, 0.5);z-index:100}.am5-modal-wrapper{top:0px;left:0px;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:rgba(255, 255, 255, 0.5);z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:left;white-space:normal;background:rgb(255, 255, 255);border-radius:4px;box-shadow:rgba(0, 0, 0, 0.45) 0px 0px 36px 0px;color:rgb(0, 0, 0)}.arcgis-charts-modal{box-shadow:none !important}.arcgis-charts-modal-header{background-color:rgba(0, 0, 0, 0.05);font-weight:bold;padding:4px 4px 4px 4px}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:0.5rem;padding:0.5rem;background:white;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:black}.sort-y-axis{transform:rotate(90deg)}calcite-panel{max-height:60vh}calcite-panel .size-section{width:19rem;margin:1rem 0;display:flex;flex-wrap:wrap;justify-content:space-evenly}calcite-panel .size-section calcite-label{width:8rem;margin-bottom:0.25rem}calcite-panel .apply-button{width:17rem}";export{P as A}