/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See LICENSE.md for details.
 * v4.32.1
 */
import{r as e,c as t,g as s,h as i,H as a,a as o}from"./p-ccd1c88c.js";import{w as l,O as n,M as r,A as c,C as h,E as d,J as p,I as b}from"./p-33adbadb.js";import{Z as f}from"./p-247471b0.js";import{e as m,U as g,c as u,d as k,i as x}from"./p-13fd0548.js";import{a as y}from"./p-e3e7b132.js";import{i as w}from"./p-7f5c1ec3.js";const v="pick-list-item-label",C="sort-mean",j="sort-median",L=class{constructor(s){e(this,s),this.arcgisChartsConfigBoxPlotDataPopoverChange=t(this,"arcgisChartsConfigBoxPlotDataPopoverChange",7),this.arcgisChartsConfigPopoverClose=t(this,"arcgisChartsConfigPopoverClose",7),this.placement="leading",this.offsetDistance=-200,this.pickListHasChanged=!1,this.closePopover=()=>{this.contentKind===y.numericFields&&this.pickListHasChanged&&m({pickListElement:this.picklist,eventEmitter:this.arcgisChartsConfigBoxPlotDataPopoverChange,contentKind:this.contentKind}),this.open=!1,this.arcgisChartsConfigPopoverClose.emit(this.pickListHasChanged)},this.onDataContentTypeChange=async e=>{this.pickListHasChanged=!0,this.arcgisChartsConfigBoxPlotDataPopoverChange.emit({contentKind:this.contentKind,value:e.target.selectedItems.map((e=>e.value))}),this.open=!1},this.onNumericFieldsChange=e=>{null!==e.target&&(this.selectedContent=e.target.selectedItems.map((e=>e.value)))},this.onNumericFieldSelectionDone=async()=>{this.pickListHasChanged&&this.closePopover()},this.createTooltip=e=>{if(e.target?.label===this.strings.customSort&&this.isCustomSortDisabled){const t=e.target,{formatLocale:s}=l(),i=new Intl.NumberFormat(s).format(g.customSortLimit),a=n(this.strings.customSortLimit,{totalLimit:i});this.tooltip=u(t),this.tooltip.innerHTML=a,document.body.appendChild(this.tooltip)}},this.destroyTooltip=()=>{k(this.tooltip)},this.headingTitle=void 0,this.referenceElement=void 0,this.open=void 0,this.contentKind=void 0,this.layerFieldsInfo=void 0,this.isCustomSortDisabled=!1,this.selectedContent=void 0}selectedContentChange(e,t){this.pickListHasChanged=!w(e,t)}async reposition(){await(this.popoverElement?.reposition())}async componentWillLoad(){({strings:this.strings}=await r(this.hostElement,s(".")))}componentDidRender(){setTimeout((async()=>{"function"==typeof this.picklist?.setFocus&&await(this.picklist?.setFocus())}),g.PopoverTimer),c(this.popoverElement,this.open)}componentDidUpdate(){setTimeout((()=>{this.popoverElement?.reposition()}),g.PopoverTimer)}buildPickListItem(e){return i("calcite-list-item",{key:e.name,label:h(this.layerFieldsInfo,e.name),value:e.name,selected:x(e.name,this.selectedContent)})}buildPickListItems(e){const t=this.layerFieldsInfo?.length??0,s=[];switch(e){case y.numericFields:for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];b(t)&&s.push(this.buildPickListItem(t))}break;case y.category:s.push(i("calcite-list-item",{label:" ",key:" ",value:" ",selected:x("",this.selectedContent)}));for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];(d(t)||t.type===p.String)&&s.push(this.buildPickListItem(t))}break;case y.splitByField:s.push(i("calcite-list-item",{label:" ",key:" ",value:" ",selected:x("",this.selectedContent)}));for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];(d(t)||t.type===p.String)&&s.push(this.buildPickListItem(t))}}return s}renderCategory(){const e=this.buildPickListItems(y.category);return i("calcite-list",{label:"",class:v,selectionMode:"single",selectionAppearance:"border",filterEnabled:!0,onCalciteListChange:this.onDataContentTypeChange,ref:e=>{this.picklist=e}},e)}renderNumericFields(){const e=this.buildPickListItems(y.numericFields);return i("calcite-list",{label:"",class:"bar-chart-data-numeric-fields-pick-list",selectionMode:"multiple",filterEnabled:!0,onCalciteListChange:this.onNumericFieldsChange,ref:e=>{this.picklist=e}},e)}renderSplitByField(){const e=this.buildPickListItems(y.splitByField);return i("calcite-list",{label:"",class:v,selectionMode:"single",selectionAppearance:"border",filterEnabled:!0,onCalciteListChange:this.onDataContentTypeChange,ref:e=>{this.picklist=e}},e)}renderSortOrder(){const e=this.buildSortOrder();return i("calcite-list",{label:"",class:"sort-order-pick-list",selectionMode:"single",selectionAppearance:"border",filterEnabled:!1,onCalciteListChange:this.onDataContentTypeChange},e)}buildSortOrder(){let e;return Object.keys(f).map((t=>{let s="";switch(t){case f.xAxisAsc:e="a-z-down";break;case f.xAxisDesc:e="a-z-up";break;case f.meanAsc:e="sort-descending",s=C;break;case f.meanDesc:e="sort-ascending",s=C;break;case f.medianAsc:e="sort-descending",s=j;break;case f.medianDesc:e="sort-ascending",s=j;break;case f.customSort:e="arrow-up-down"}return i("calcite-list-item",{disabled:this.isCustomSortDisabled&&t===f.customSort,key:t,label:this.strings[t],selected:this.selectedContent===t,value:f[t],onMouseOver:this.createTooltip,onMouseOut:this.destroyTooltip},i("calcite-icon",{class:`sort-icon-color ${s}`,slot:"content-start",icon:e}))}))}renderPopoverInfo(){let e;switch(this.contentKind){case y.category:e=this.renderCategory();break;case y.numericFields:e=this.renderNumericFields();break;case y.splitByField:e=this.renderSplitByField();break;case y.sortOrder:e=this.renderSortOrder()}return e}render(){let e;return this.contentKind===y.numericFields&&(e=i("div",{key:"2ba8d441c029b5188c8e3da44dff415e5e6757e1",slot:"footer"},i("calcite-fab",{key:"44fa1bbb636eb121709a7174cb224131ba6f07f8",class:"fab",appearance:"outline-fill",kind:"neutral",icon:"",label:this.strings.selectionDone,scale:"s","text-enabled":!0,text:this.strings.selectionDone,onClick:this.onNumericFieldSelectionDone}))),i(a,{key:"d017ed79b794d79baabaa4066f7df1f38c01ec32",class:"js-app-flyout"},i("calcite-popover",{key:"04332f7cca5187dc61d4c095944eee56b7e9c0d8",class:"bar-chart-data-popover",referenceElement:this.referenceElement,placement:this.placement,offsetDistance:this.offsetDistance,open:this.open,onCalcitePopoverClose:this.closePopover,label:"",ref:e=>{this.popoverElement=e}},i("calcite-panel",{key:"b8f212fc5ea8a98aa0e1074574dd587b9f897755",class:"panel",closable:!0,closed:!this.open,onCalcitePanelClose:this.closePopover},i("div",{key:"13d238aaf6bfa9dcbbbc302ddeece3d0905a4a57",slot:"header-content",class:"header"},this.headingTitle??""),this.renderPopoverInfo(),e)))}static get assetsDirs(){return["assets"]}get hostElement(){return o(this)}static get watchers(){return{selectedContent:["selectedContentChange"]}}};L.style=".hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0px;left:0px}.am5-modal-curtain{top:0px;left:0px;width:100%;height:100%;position:absolute;background:rgba(255, 255, 255, 0.5);z-index:100}.am5-modal-wrapper{top:0px;left:0px;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:rgba(255, 255, 255, 0.5);z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:left;white-space:normal;background:rgb(255, 255, 255);border-radius:4px;box-shadow:rgba(0, 0, 0, 0.45) 0px 0px 36px 0px;color:rgb(0, 0, 0)}.arcgis-charts-modal{box-shadow:none !important}.arcgis-charts-modal-header{background-color:rgba(0, 0, 0, 0.05);font-weight:bold;padding:4px 4px 4px 4px}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:0.5rem;padding:0.5rem;background:white;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:black}.sort-mean,.sort-median{transform:rotate(90deg)}.sort-order-pick-list{overflow-y:hidden}.panel{max-height:60vh}";export{L as A}