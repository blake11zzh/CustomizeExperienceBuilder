/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See LICENSE.md for details.
 * v4.32.1
 */
import{r as e,c as t,g as i,h as s,H as a,a as c}from"./p-ccd1c88c.js";import{M as l,y as n,A as o,C as r,E as h,J as d,I as p}from"./p-33adbadb.js";import{e as b}from"./p-247471b0.js";import{P as f}from"./p-e3e7b132.js";import{e as m,p as g,U as u,i as k}from"./p-13fd0548.js";import{i as x}from"./p-7f5c1ec3.js";const y="pick-list-item-label",C="sort-counter-clockwise",w=class{constructor(i){e(this,i),this.arcgisChartsConfigPieChartDataPopoverChange=t(this,"arcgisChartsConfigPieChartDataPopoverChange",7),this.arcgisChartsConfigPopoverClose=t(this,"arcgisChartsConfigPopoverClose",7),this.placement="leading",this.offsetDistance=-200,this.pickListHasChanged=!1,this.closePopover=()=>{this.contentKind===f.numericFields&&this.pickListHasChanged&&m({pickListElement:this.picklist,eventEmitter:this.arcgisChartsConfigPieChartDataPopoverChange,contentKind:this.contentKind}),this.open=!1,this.arcgisChartsConfigPopoverClose.emit(this.pickListHasChanged)},this.onDataContentTypeChange=e=>{this.pickListHasChanged=!0,this.arcgisChartsConfigPieChartDataPopoverChange.emit({contentKind:this.contentKind,value:e.target.selectedItems.map((e=>e.value))}),this.open=!1},this.onNumericFieldsChange=e=>{null!==e.target&&(this.selectedContent=e.target.selectedItems.map((e=>e.value)))},this.onNumericFieldSelectionDone=()=>{this.pickListHasChanged&&this.closePopover()},this.headingTitle=void 0,this.referenceElement=void 0,this.open=void 0,this.contentKind=void 0,this.layerFieldsInfo=void 0,this.selectedContent=void 0}selectedContentChange(e,t){this.pickListHasChanged=!x(e,t)}async reposition(){await(this.popoverElement?.reposition())}async componentWillLoad(){({strings:this.strings}=await l(this.hostElement,i(".")))}async componentWillRender(){const e=g.map((async e=>await n(e)));this.aggregationLabels=await Promise.all(e)}componentDidRender(){setTimeout((async()=>{await(this.picklist?.setFocus())}),u.PopoverTimer),o(this.popoverElement,this.open)}renderAggregationType(){const e=this.buildAggregationPickListItems();return s("calcite-list",{label:"",class:y,selectionMode:"single",selectionAppearance:"border",filterEnabled:!1,onCalciteListChange:this.onDataContentTypeChange},e)}buildAggregationPickListItems(){return g.map(((e,t)=>s("calcite-list-item",{label:this.aggregationLabels[t],key:e,value:e,selected:k(e,this.selectedContent)})))}renderCategory(){const e=this.buildPickListItems(f.category);return s("calcite-list",{label:"",class:y,selectionMode:"single",selectionAppearance:"border",filterEnabled:!0,onCalciteListChange:this.onDataContentTypeChange,ref:e=>{this.picklist=e}},e)}renderNumericFields(){const e=this.buildPickListItems(f.numericFields);return s("calcite-list",{label:"",class:"pie-chart-data-numeric-fields-pick-list",selectionMode:"multiple",filterEnabled:!0,onCalciteListChange:this.onNumericFieldsChange,ref:e=>{this.picklist=e}},e)}renderSortOrder(){const e=this.buildSortOrder();return s("calcite-list",{label:"",selectionMode:"single",selectionAppearance:"border",filterEnabled:!1,onCalciteListChange:this.onDataContentTypeChange},e)}buildSortOrder(){const e=Object.keys(b);return e.splice(e.indexOf(b.customSort),1),e.map((e=>{let t="string",i="";switch(e){case b.labelAsc:t="string";break;case b.labelDesc:t="string",i=C;break;case b.valueAsc:t="number";break;case b.valueDesc:t="number",i=C}return s("calcite-list-item",{selected:this.selectedContent===e,key:e,label:this.strings[e],value:b[e]},s("calcite-icon",{slot:"content-end",icon:t}),s("calcite-icon",{class:i,slot:"content-end",icon:"rotate"}))}))}buildPickListItem(e){return s("calcite-list-item",{key:e.name,label:r(this.layerFieldsInfo,e.name),value:e.name,selected:k(e.name,this.selectedContent)})}buildPickListItems(e){const t=this.layerFieldsInfo?.length??0,i=[];switch(e){case f.numericFields:for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];p(t)&&i.push(this.buildPickListItem(t))}break;case f.category:i.push(s("calcite-list-item",{label:" ",key:" ",value:" ",selected:k("",this.selectedContent)}));for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];(h(t)||t.type===d.String)&&i.push(this.buildPickListItem(t))}}return i}renderPopoverInfo(){let e;switch(this.contentKind){case f.aggregation:e=this.renderAggregationType();break;case f.category:e=this.renderCategory();break;case f.numericFields:e=this.renderNumericFields();break;case f.sortOrder:e=this.renderSortOrder()}return e}render(){let e;return this.contentKind===f.numericFields&&(e=s("div",{key:"c724640b31c36da7a8d04c49ff9f02335743cef4",slot:"footer"},s("calcite-fab",{key:"4bc04304adcf2bcf158cd73cb0fe18c45826476a",class:"fab",appearance:"outline-fill",kind:"neutral",icon:"",label:this.strings.selectionDone,scale:"s","text-enabled":!0,text:this.strings.selectionDone,onClick:this.onNumericFieldSelectionDone}))),s(a,{key:"6803285fafc88cdc9f5e3a6d56adda5340286ac0",class:"js-app-flyout"},s("calcite-popover",{key:"c42b35f11af5343ec04913c6a68cc9acffc2e5e6",class:"pie-chart-data-popover",referenceElement:this.referenceElement,placement:this.placement,onCalcitePopoverClose:this.closePopover,offsetDistance:this.offsetDistance,open:this.open,label:"",ref:e=>{this.popoverElement=e}},s("calcite-panel",{key:"6c1f43eb0cd5bfece088b12da0c4e33f88c14f3c",class:"panel",closable:!0,closed:!this.open,onCalcitePanelClose:this.closePopover},s("div",{key:"44ffa52698271f705ef9f3588789499f77e5e534",slot:"header-content",class:"header"},this.headingTitle??""),this.renderPopoverInfo(),e)))}static get assetsDirs(){return["assets"]}get hostElement(){return c(this)}static get watchers(){return{selectedContent:["selectedContentChange"]}}};w.style=".hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0px;left:0px}.am5-modal-curtain{top:0px;left:0px;width:100%;height:100%;position:absolute;background:rgba(255, 255, 255, 0.5);z-index:100}.am5-modal-wrapper{top:0px;left:0px;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:rgba(255, 255, 255, 0.5);z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:left;white-space:normal;background:rgb(255, 255, 255);border-radius:4px;box-shadow:rgba(0, 0, 0, 0.45) 0px 0px 36px 0px;color:rgb(0, 0, 0)}.arcgis-charts-modal{box-shadow:none !important}.arcgis-charts-modal-header{background-color:rgba(0, 0, 0, 0.05);font-weight:bold;padding:4px 4px 4px 4px}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:0.5rem;padding:0.5rem;background:white;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:black}.sort-counter-clockwise{transform:scaleX(-1)}.panel{max-height:60vh}";export{w as A}