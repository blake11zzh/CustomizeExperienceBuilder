/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See LICENSE.md for details.
 * v4.32.1
 */
import{r as e,c as t,g as s,h as i,H as a,a as l}from"./p-ccd1c88c.js";import{w as o,O as c,M as r,y as n,A as h,C as d,E as p,J as b,I as f,R as m}from"./p-33adbadb.js";import{J as g}from"./p-247471b0.js";import{B as u}from"./p-e3e7b132.js";import{U as k,c as x,d as y,e as w,a as C,i as v}from"./p-13fd0548.js";import{i as L}from"./p-7f5c1ec3.js";const j="pick-list-item-label",E="sort-y-axis",P=class{constructor(s){e(this,s),this.arcgisChartsConfigBarChartDataPopoverChange=t(this,"arcgisChartsConfigBarChartDataPopoverChange",7),this.arcgisChartsConfigPopoverClose=t(this,"arcgisChartsConfigPopoverClose",7),this.placement="leading",this.offsetDistance=-200,this.pickListHasChanged=!1,this.createTooltip=e=>{if(e.target?.label===this.strings.customSort&&this.isCustomSortDisabled){const t=e.target,{formatLocale:s}=o(),i=new Intl.NumberFormat(s).format(k.customSortLimit),a=c(this.strings.customSortLimit,{totalLimit:i});this.tooltip=x(t),this.tooltip.innerHTML=a,document.body.appendChild(this.tooltip)}},this.destroyTooltip=()=>{y(this.tooltip)},this.closePopover=()=>{this.contentKind===u.numericFields&&this.pickListHasChanged&&w({pickListElement:this.picklist,eventEmitter:this.arcgisChartsConfigBarChartDataPopoverChange,contentKind:this.contentKind}),this.open=!1,this.arcgisChartsConfigPopoverClose.emit(this.pickListHasChanged)},this.onDataContentTypeChange=e=>{this.pickListHasChanged=!0,this.arcgisChartsConfigBarChartDataPopoverChange.emit({contentKind:this.contentKind,value:e.target.selectedItems.map((e=>e.value))}),this.open=!1},this.onNumericFieldsChange=e=>{null!==e.target&&(this.selectedContent=e.target.selectedItems.map((e=>e.value)))},this.onNumericFieldSelectionDone=()=>{this.pickListHasChanged&&this.closePopover()},this.headingTitle=void 0,this.referenceElement=void 0,this.open=void 0,this.contentKind=void 0,this.layerFieldsInfo=void 0,this.selectedContent=void 0,this.isCustomSortDisabled=!1,this.isNoAggregationDisabled=!1}selectedContentChange(e,t){this.pickListHasChanged=!L(e,t)}async reposition(){await(this.popoverElement?.reposition())}async componentWillLoad(){({strings:this.strings}=await r(this.hostElement,s(".")))}async componentWillRender(){const e=C.map((async e=>await n(e)));this.aggregationLabels=await Promise.all(e)}componentDidRender(){setTimeout((async()=>{await(this.picklist?.setFocus())}),k.PopoverTimer),h(this.popoverElement,this.open)}componentDidUpdate(){setTimeout((()=>{this.popoverElement?.reposition()}),k.PopoverTimer)}renderAggregationType(){const e=this.buildAggregationListItems();return i("calcite-list",{label:"",class:j,filterEnabled:!1,selectionMode:"single",selectionAppearance:"border",onCalciteListChange:this.onDataContentTypeChange},e)}buildAggregationListItems(){return(this.isNoAggregationDisabled?C.filter((e=>e!==m.NoAggregation)):C).map(((e,t)=>i("calcite-list-item",{label:this.aggregationLabels[t],key:e,value:e,selected:v(e,this.selectedContent)})))}renderCategory(){const e=this.buildPickListItems(u.category);return i("calcite-list",{label:"",class:j,selectionMode:"single",selectionAppearance:"border",filterEnabled:!0,onCalciteListChange:this.onDataContentTypeChange,ref:e=>{this.picklist=e}},e)}renderNumericFields(){const e=this.buildPickListItems(u.numericFields);return i("calcite-list",{label:"",class:"bar-chart-data-numeric-fields-pick-list",selectionMode:"multiple",filterEnabled:!0,onCalciteListChange:this.onNumericFieldsChange,ref:e=>{this.picklist=e}},e)}renderSortOrder(){const e=this.buildSortOrder();return i("calcite-list",{label:"",class:"sort-order-pick-list",selectionMode:"single",selectionAppearance:"border",filterEnabled:!1,onCalciteListChange:this.onDataContentTypeChange},e)}renderSplitByField(){const e=this.buildPickListItems(u.splitByField);return i("calcite-list",{label:"",class:j,selectionMode:"single",selectionAppearance:"border",filterEnabled:!0,onCalciteListChange:this.onDataContentTypeChange,ref:e=>{this.picklist=e}},e)}buildSortOrder(){let e;return Object.keys(g).map((t=>{let s="";switch(t){case g.xAxisAsc:e="a-z-down";break;case g.xAxisDesc:e="a-z-up";break;case g.yAxisAsc:e="sort-descending",s=E;break;case g.yAxisDesc:e="sort-ascending",s=E;break;case g.customSort:e="arrow-up-down"}return i("calcite-list-item",{disabled:this.isCustomSortDisabled&&t===g.customSort,key:t,label:this.strings[t],selected:this.selectedContent===t,value:g[t],onMouseOver:this.createTooltip,onMouseOut:this.destroyTooltip},i("calcite-icon",{class:`sort-icon-color ${s}`,slot:"content-start",icon:e}))}))}buildPickListItem(e){return i("calcite-list-item",{key:e.name,label:d(this.layerFieldsInfo,e.name),value:e.name,selected:v(e.name,this.selectedContent)})}buildPickListItems(e){const t=this.layerFieldsInfo?.length??0,s=[];switch(e){case u.numericFields:for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];f(t)&&s.push(this.buildPickListItem(t))}break;case u.category:s.push(i("calcite-list-item",{label:" ",key:" ",value:" ",selected:v("",this.selectedContent)}));for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];(p(t)||t.type===b.String||t.type===b.Date)&&s.push(this.buildPickListItem(t))}break;case u.splitByField:s.push(i("calcite-list-item",{label:" ",key:" ",value:" ",selected:v("",this.selectedContent)}));for(let e=0;e<t;e+=1){const t=this.layerFieldsInfo[e];(p(t)||t.type===b.String)&&s.push(this.buildPickListItem(t))}}return s}renderPopoverInfo(){let e;switch(this.contentKind){case u.aggregation:e=this.renderAggregationType();break;case u.category:e=this.renderCategory();break;case u.numericFields:e=this.renderNumericFields();break;case u.splitByField:e=this.renderSplitByField();break;case u.sortOrder:e=this.renderSortOrder()}return e}render(){let e;return this.contentKind===u.numericFields&&(e=i("div",{key:"69b4e11d8b5b58db2fd66b490af834be3bde07f2",slot:"footer"},i("calcite-fab",{key:"25c16bead2fcc1938ca60dd1f1f99cb11766b8e5",class:"fab",appearance:"outline-fill",kind:"neutral",icon:"",label:this.strings.selectionDone,scale:"s","text-enabled":!0,text:this.strings.selectionDone,onClick:this.onNumericFieldSelectionDone}))),i(a,{key:"e11752f4a12ed99d65009ec64402333acb533ec3",class:"js-app-flyout"},i("calcite-popover",{key:"51dbaeb420b4ed674ad919029eb3cec6c405cc38",class:"bar-chart-data-popover",referenceElement:this.referenceElement,placement:this.placement,offsetDistance:this.offsetDistance,open:this.open,onCalcitePopoverClose:this.closePopover,label:"",ref:e=>{this.popoverElement=e}},i("calcite-panel",{key:"ff4f392843ccf06cd864d96c95e5edcf786bfc34",class:"panel",closable:!0,closed:!this.open,onCalcitePanelClose:this.closePopover},i("div",{key:"d9715b90dafd2a45ad6f2764a4648253be50d0d7",slot:"header-content",class:"header"},this.headingTitle??""),this.renderPopoverInfo(),e)))}static get assetsDirs(){return["assets"]}get hostElement(){return l(this)}static get watchers(){return{selectedContent:["selectedContentChange"]}}};P.style=".hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0px;left:0px}.am5-modal-curtain{top:0px;left:0px;width:100%;height:100%;position:absolute;background:rgba(255, 255, 255, 0.5);z-index:100}.am5-modal-wrapper{top:0px;left:0px;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:rgba(255, 255, 255, 0.5);z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:left;white-space:normal;background:rgb(255, 255, 255);border-radius:4px;box-shadow:rgba(0, 0, 0, 0.45) 0px 0px 36px 0px;color:rgb(0, 0, 0)}.arcgis-charts-modal{box-shadow:none !important}.arcgis-charts-modal-header{background-color:rgba(0, 0, 0, 0.05);font-weight:bold;padding:4px 4px 4px 4px}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}.name{display:flex;flex-direction:column;margin:0.5rem;padding:0.5rem;background:white;min-width:250px}.header{margin:0;font-weight:bolder}.fab{display:flex;justify-content:stretch}.pick-list-item-label{font-size:small}.sort-icon-color{color:black}.sort-y-axis{transform:rotate(90deg)}.sort-order-pick-list{overflow-y:hidden}.panel{max-height:60vh}";export{P as A}