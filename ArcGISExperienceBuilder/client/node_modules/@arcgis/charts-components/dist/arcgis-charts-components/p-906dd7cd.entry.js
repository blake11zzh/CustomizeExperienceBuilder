/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See LICENSE.md for details.
 * v4.32.1
 */
import{r as t,c as i,g as s,h as e,H as a,a as h}from"./p-ccd1c88c.js";import{R as c,aa as l,M as n,y as r,N as o,_ as d,C as b,Z as f,r as g,a5 as m,J as p,m as u}from"./p-33adbadb.js";import{L as C}from"./p-e3e7b132.js";import{d as y,s as k}from"./p-0a7e5e35.js";import{d as v,g as x}from"./p-5a099bb2.js";import{h as w,k as S}from"./p-13fd0548.js";import"./p-247471b0.js";const I="label",j="arcgis-charts-rtl",L=class{constructor(s){t(this,s),this.arcgisChartsConfigLineChartDataNumericFieldValidate=i(this,"arcgisChartsConfigLineChartDataNumericFieldValidate",7),this.arcgisChartsConfigDataChangeError=i(this,"arcgisChartsConfigDataChangeError",7),this.arcgisChartsConfigCustomizedTimeInterval=i(this,"arcgisChartsConfigCustomizedTimeInterval",7),this.arcgisChartsConfigResetTimeInterval=i(this,"arcgisChartsConfigResetTimeInterval",7),this.lineChartPopover=null,this.resetTimeIntervalOriginal=t=>{this.popoverClose(t),void 0!==this.model.resetTimeInterval&&(this.model.resetTimeInterval(),this.arcgisChartsConfigResetTimeInterval.emit())},this.onAggregationSelect=()=>{this.contentKind=C.aggregation,this.setupPopover()},this.onXAxisFieldSelect=()=>{this.contentKind=C.xAxisField,this.setupPopover()},this.onSplitBySelect=()=>{this.splitByFieldElement.disabled||(this.contentKind=C.splitByField,this.setupPopover())},this.onAddNumericFields=()=>{this.contentKind=C.numericFields,this.setupPopover()},this.onRemoveNumericField=async t=>{const i=t.target.value;await this.model.setNumericFields(this.model.getNumericFields().filter((t=>t!==i)))},this.onIntervalAlignmentSelect=()=>{this.intervalAlignmentElement.disabled||(this.contentKind=C.intervalAlignment,this.setupPopover())},this.onIntervalSelect=()=>{this.intervalElement.disabled||(this.contentKind=C.interval,this.setupPopover())},this.onLineChartDataChange=async t=>{try{if(null!==t.detail&&void 0!==t.detail?.value){const{contentKind:i}=t.detail,s=[...t.detail.value];switch(y(k),i){case C.aggregation:await this.model.setAggregationType(s[0]!==c.NoAggregation?s[0]:c.NoAggregation);break;case C.xAxisField:{const t=s[0]?.trim()||"";await this.model.setXAxisField(t),this.arcgisChartsConfigResetTimeInterval.emit();break}case C.numericFields:await this.model.setNumericFields(s),this.model.getNumericFields().length>0&&this.model.getAggregationType()===c.Count&&this.model.getNumericFields()[0]!==l(this.layerFieldsInfo)&&await this.model.setAggregationType(c.Sum);break;case C.splitByField:{const t=s[0]?.trim()||"";await this.model.setSplitByField(t),this.model.setColorMatch(!0);break}case C.interval:this.model.setTimeIntervalSize(s[0]?.intervalSize),this.model.setTimeIntervalUnits(s[0]?.intervalUnits),this.arcgisChartsConfigCustomizedTimeInterval.emit();break;case C.intervalAlignment:this.model.setTimeAggregationType(s[0]??"")}}}catch(t){throw this.arcgisChartsConfigDataChangeError.emit({error:t,model:this.model}),t}this.removeLineChartDataPopover(),this.updatesOccurred=this.updatesOccurred+1},this.onShowDataLabelsChange=t=>{this.model.setDataLabelsVisibility(t.target.checked)},this.onTrimIncompleteIntervalChange=t=>{this.model.setTrimIncompleteTimeInterval(t.target.checked)},this.onNullPolicyChange=t=>{this.model.setNullPolicy(t.target.selectedItem.value)},this.onModelConfigChange=()=>{this.updatesOccurred=this.updatesOccurred+1},this.popoverClose=t=>{this.lineChartPopover===t?.target&&this.removeLineChartDataPopover()},this.model=void 0,this.resetTimeInterval=void 0,this.layerFieldsInfo=void 0,this.open=!0,this.updatesOccurred=0}modelChange(t,i){i?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),t?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}disconnectedCallback(){this.removeLineChartDataPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}async componentWillLoad(){({strings:this.strings,direction:this.direction}=await n(this.hostElement,s("."))),this.modelChange(this.model),this.onModelConfigChange()}async componentWillRender(){this.aggregationLabel=await r(this.model.getAggregationType());const t=this.model.getTimeAggregationType();void 0!==t&&(this.timeAggregationLabel=await o(t)),this.disableSplitBy=this.model.getNumericFields().length>1}renderAggregation(){return e("arcgis-charts-config-field-select",{label:this.model.getAggregationType()===c.NoAggregation?this.strings.noAggregation:this.aggregationLabel,ref:t=>{this.aggregationElement=t},onClick:this.onAggregationSelect})}renderXAxisField(){const t=this.getCorrectedXAxisValue();return e("arcgis-charts-config-field-select",{label:t,ref:t=>{this.xAxisFieldElement=t},onClick:this.onXAxisFieldSelect})}renderSplitBy(){const t=this.getCorrectedSplitByValue();return e("arcgis-charts-config-field-select",{label:t,disabled:this.disableSplitBy,ref:t=>{this.splitByFieldElement=t},onClick:this.onSplitBySelect})}renderNumericFields(t){const i=l(this.layerFieldsInfo),s=[];for(let e=0;e<t.length;e+=1)t[e]!==i&&s.push(this.buildNumericFieldItem(t[e]));return e("calcite-list",{label:"",class:"field-list",ref:t=>{this.numericFieldsElement=t}},s)}renderInterval(){const t=(this.model.getTimeIntervalSize()??0)<=0,i=this.model.getTimeIntervalSize()??"",s=d(this.model.getTimeIntervalUnits()??v.Seconds,this.strings)??"";return[e("calcite-list",{label:"",selectionAppearance:"border"},e("calcite-list-item",{value:t?"":`${i} ${s}`,label:t?"":`${i} ${s}`,ref:t=>{this.intervalElement=t},onClick:t?()=>{}:this.onIntervalSelect},e("calcite-icon",{slot:"content-end",icon:"pencil"}))),e("div",{class:"link-container"},e("calcite-button",{appearance:"transparent",scale:"s",iconEnd:"reset",onClick:this.resetTimeIntervalOriginal},this.strings.reset))]}renderIntervalAlignment(){return e("arcgis-charts-config-field-select",{label:this.timeAggregationLabel,disabled:!1,ref:t=>{this.intervalAlignmentElement=t},onClick:this.onIntervalAlignmentSelect})}renderEmptyBins(){return e("calcite-radio-button-group",{name:"empty-bins",layout:"vertical",onCalciteRadioButtonGroupChange:this.onNullPolicyChange},e("calcite-label",{layout:"inline"},e("calcite-radio-button",{value:x.Zero,checked:this.model.getNullPolicy()===x.Zero}),this.strings.treatAsZero),e("calcite-label",{layout:"inline"},e("calcite-radio-button",{value:x.Interpolate,checked:this.model.getNullPolicy()===x.Interpolate}),this.strings.connectLine),e("calcite-label",{layout:"inline"},e("calcite-radio-button",{value:x.Null,checked:this.model.getNullPolicy()===x.Null}),this.strings.breakLine))}buildNumericFieldItem(t){return e("calcite-list-item",{label:b(this.layerFieldsInfo,t),value:t,key:t,closable:!0,onCalciteListItemClose:this.onRemoveNumericField})}render(){const t=this.renderAggregation(),i=this.renderXAxisField(),s=this.renderSplitBy(),h=this.renderNumericFields([...this.model.getNumericFields()]),c=this.renderInterval(),l=this.renderIntervalAlignment(),n=this.renderEmptyBins();return e(a,{key:"b6451eb6ec2b1d61dabc871233690263e1e794d9",class:{[j]:"rtl"===this.direction}},e("calcite-label",{key:"06c94128f7c237740b6d13aecc4f3f558f4b5467",class:I},this.strings.xAxisField,i),e("calcite-label",{key:"5f811e5ccc7b591b235eb0e9f29c263d136faca3",class:I},this.strings.aggregation,t),e("calcite-label",{key:"32789b718f017c6a838269ee6fc6aed3dee48ed4",class:I},this.strings.numericFields,h),e("div",{key:"b4d894b98efbebf17b59c3369aa9276541d9d246",class:"fab"},e("calcite-fab",{key:"f430a7551f1939969dc87e9ca4362847703c8884",appearance:"outline-fill",kind:"neutral",scale:"m",label:this.strings.selectNumericFields,"text-enabled":!0,text:this.strings.selectNumericFields,icon:"plus",onClick:this.onAddNumericFields})),e("calcite-label",{key:"55fd93a584f2c08e835f2dd892e69c3206996174",class:I},e("span",{key:"81f68686c3a64f9747f5f5bf08afecd1496cf2e0",class:this.disableSplitBy?"dim-text":""},this.strings.splitBy),s),e("div",{key:"b249e03ec9f0ac5692730e15cf2df636ddc73e0e",hidden:!this.shouldShowTimeBinning()},e("h3",{key:"af2c5bca4a508f8ef25b47f8b302bbd511c1e916",class:"time-binning-header"},this.strings.timeBinningOptions),e("calcite-label",{key:"dd23237541552296bfd92831efaca1a4b2b5dac3",class:I},this.strings.interval,c),e("calcite-label",{key:"022b35e04bf70f525630e6ae160181882790c317",class:I},this.strings.intervalAlignment,l),e("calcite-label",{key:"4cc20bb8cdb6f7d780188a10b3af8a5929d841c8",class:I,layout:"inline-space-between"},this.strings.trimIncompleteInterval,e("calcite-switch",{key:"fffe1ad70264153507220b9a7125e5c9c2dd1235",checked:this.model.getTrimIncompleteTimeInterval(),onCalciteSwitchChange:this.onTrimIncompleteIntervalChange})),e("calcite-label",{key:"e0e359e36873a557d6b9ed2e6c990fb5bc2b656b",class:I},this.strings.emptyBins,n)),e("calcite-label",{key:"be1c2ad0ed5fe37e8a4206df7a51e6f5f4c2e040",class:I,layout:"inline-space-between"},this.strings.showDataLabels,e("calcite-switch",{key:"ce968955a4afcf74795da6cfa5b345a37bf4858e",checked:this.model.getDataLabelsVisibility(),onCalciteSwitchChange:this.onShowDataLabelsChange})))}getCorrectedSplitByValue(){return""===this.model.getSplitByField()||this.model.getNumericFields().length>1?"":b(this.layerFieldsInfo,this.model.getSplitByField())}getCorrectedXAxisValue(){return this.model.getXAxisField()===w||""===this.model.getXAxisField().trim()?"":b(this.layerFieldsInfo,this.model.getXAxisField())}shouldShowTimeBinning(){const t=this.layerFieldsInfo.find((t=>t.name===this.model.getXAxisField())),i=t?.type===p.Date,s=this.model.getAggregationType()!==c.NoAggregation;return i&&s}setupPopover(){if(this.removeLineChartDataPopover(),this.lineChartPopover=f(g.LineChartDataPopover,{layerFieldsInfo:this.layerFieldsInfo,onLineChartDataChange:this.onLineChartDataChange,popoverClose:this.popoverClose}),null!==this.lineChartPopover){const t={timeIntervalSize:this.model.getTimeIntervalSize()??1,timeIntervalUnits:this.model.getTimeIntervalUnits()??v.Seconds};switch(this.contentKind){case C.aggregation:this.lineChartPopover.referenceElement=this.aggregationElement,this.lineChartPopover.headingTitle=this.strings.aggregationHeader,this.lineChartPopover.selectedContent=this.model.getAggregationType();break;case C.xAxisField:this.lineChartPopover.referenceElement=this.xAxisFieldElement,this.lineChartPopover.headingTitle=this.strings.xAxisFieldHeader,this.lineChartPopover.selectedContent=this.model.getXAxisField();break;case C.numericFields:this.lineChartPopover.referenceElement=this.numericFieldsElement,this.lineChartPopover.headingTitle=this.strings.numericFieldsHeader,this.lineChartPopover.selectedContent=this.model.getNumericFields();break;case C.splitByField:this.lineChartPopover.referenceElement=this.splitByFieldElement,this.lineChartPopover.headingTitle=this.strings.splitByFieldHeader,this.lineChartPopover.selectedContent=this.model.getSplitByField();break;case C.interval:this.lineChartPopover.referenceElement=this.intervalElement,this.lineChartPopover.headingTitle=this.strings.editInterval,this.lineChartPopover.selectedContent=t;break;case C.intervalAlignment:this.lineChartPopover.referenceElement=this.intervalAlignmentElement,this.lineChartPopover.headingTitle=this.strings.intervalAlignment,this.lineChartPopover.selectedContent=this.model.getTimeAggregationType()??""}this.lineChartPopover.contentKind=this.contentKind,this.lineChartPopover.open=!0,this.addPopover()}}addPopover(){document.body.contains(this.lineChartPopover)||null===this.lineChartPopover||document.body.appendChild(this.lineChartPopover)}removeLineChartDataPopover(){null!==this.lineChartPopover&&(this.lineChartPopover.open=!1,this.lineChartPopover=m(this.lineChartPopover))}static get assetsDirs(){return["assets"]}get hostElement(){return h(this)}static get watchers(){return{model:["modelChange"]}}};L.style=".hide{display:none}.am5-modal{width:100%;height:100%;position:absolute;z-index:100000;top:0px;left:0px}.am5-modal-curtain{top:0px;left:0px;width:100%;height:100%;position:absolute;background:rgba(255, 255, 255, 0.5);z-index:100}.am5-modal-wrapper{top:0px;left:0px;width:100%;height:100%;position:absolute;display:flex;align-items:center;justify-content:center;white-space:nowrap;background:rgba(255, 255, 255, 0.5);z-index:101}.am5-modal-content{display:inline-block;padding:1.2em;vertical-align:middle;text-align:left;white-space:normal;background:rgb(255, 255, 255);border-radius:4px;box-shadow:rgba(0, 0, 0, 0.45) 0px 0px 36px 0px;color:rgb(0, 0, 0)}.arcgis-charts-modal{box-shadow:none !important}.arcgis-charts-modal-header{background-color:rgba(0, 0, 0, 0.05);font-weight:bold;padding:4px 4px 4px 4px}.show{display:block}.notifyPanel{flex:0 1 auto}.disable-interactions{pointer-events:none}.dim-text{color:var(--arcgis-charts-dim-text)}:host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin);margin-top:var(--arcgis-charts-top-section-margin)}.label,.disabled-label{display:flex;margin-left:0.5rem;margin-right:0.5rem;margin-bottom:0.5rem;justify-content:space-between}.time-binning-header{display:flex;font-weight:bold;margin-left:0.5rem;margin-right:0.5rem;justify-content:space-between}.text{display:flex;margin-left:0.5rem;width:calc(100% - 1.5rem);height:2rem;margin-bottom:0.5rem;justify-content:space-between}.field-list{max-height:50vh;overflow-y:auto}.disabled-label{pointer-events:none}.fab{display:flex;margin-left:0.5rem;margin-right:0.5rem;margin-bottom:1.5rem;justify-content:center}.link-container{display:flex;justify-content:flex-end}:host(.arcgis-chart-rtl) .text{margin-left:0rem;margin-right:0.5rem}";const _=class{constructor(s){t(this,s),this.arcgisChartsConfigLineChartSeriesPopoverChange=i(this,"arcgisChartsConfigLineChartSeriesPopoverChange",7),this.arcgisChartsConfigPopoverOpenChange=i(this,"arcgisChartsConfigPopoverOpenChange",7),this.seriesPopover=null,this.resetSeriesOriginal=async()=>{this.configSeriesOpen=!1,this.selectedSeriesIndex=void 0,await this.model.resetSeriesStyling()},this.seriesNameChange=t=>{if(null!==t.detail||void 0!==t.detail){const i=t.detail?.name;this.model.setSeriesName(i,this.selectedSeriesIndex??-1)}},this.seriesColorChange=t=>{if(null!=t.detail){const{color:i}=t.detail;this.model.setColorMatch(!1),void 0!==i&&(this.model.setSeriesColor(i,this.selectedSeriesIndex??-1),this.model.setSeriesMarkerColor(i,this.selectedSeriesIndex??-1))}},this.seriesLineStyleChange=t=>{if(null!=t.detail){const{lineStyle:i}=t.detail;void 0!==i&&this.model.setSeriesLineStyle(i,this.selectedSeriesIndex??-1)}},this.seriesLineWidthChange=t=>{if(null!=t.detail){const{lineWidth:i}=t.detail;void 0!==i&&(this.model.setSeriesLineWidth(i,this.selectedSeriesIndex??-1),this.model.setSeriesMarkerSize(2*i,this.selectedSeriesIndex??-1))}},this.onCalciteListOrderChange=t=>{if(null!=t.detail){const{newIndex:i,oldIndex:s}=t.detail;this.model.moveSeries(s,i)}},this.seriesPopoverClose=()=>{this.selectedSeriesIndex=void 0,this.configSeriesOpen=!1},this.seriesPopoverChange=t=>{this.arcgisChartsConfigLineChartSeriesPopoverChange.emit({open:t,element:this.seriesPopover})},this.openSeriesPopOver=t=>{const i=t.target,s=!this.configSeriesOpen,e=this.model.getSeriesIndex(("calcite-list-item"===i.localName?i:i.parentNode).value);this.configSeriesOpen=this.selectedSeriesIndex!==e||s,this.selectedSeriesIndex=this.configSeriesOpen?e:void 0},this.onModelConfigChange=()=>{this.updatesOccurred=this.updatesOccurred+1},this.openChange=t=>{this.arcgisChartsConfigPopoverOpenChange.emit(t.detail)},this.model=void 0,this.configSeriesOpen=!1,this.activeColorMatch=!1,this.popoverPlacement="leading",this.selectedSeriesIndex=void 0,this.updatesOccurred=0,this.isResetAvailable=!1}modelChange(t,i){i?.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange),t?.addEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}selectedSeriesIndexChange(){void 0!==this.selectedSeriesIndex&&this.configSeriesOpen?(this.setupSeriesPopover(),null!==this.seriesPopover&&(this.seriesPopover.selectedName=this.model.getSeriesName(this.selectedSeriesIndex),this.seriesPopover.selectedColor=this.model.getSeriesColor(this.selectedSeriesIndex),this.seriesPopover.selectedLineStyle=this.model.getSeriesLineStyle(this.selectedSeriesIndex),this.seriesPopover.selectedLineWidth=this.model.getSeriesLineWidth(this.selectedSeriesIndex),this.seriesPopover.open||(this.seriesPopover.open=!0)),this.addSeriesPopover()):this.removeSeriesPopover()}removeSeriesPopover(){null!=this.seriesPopover&&(this.seriesPopover.open=!1,this.seriesPopover=m(this.seriesPopover)),this.seriesPopoverChange(!1)}async componentWillLoad(){({strings:this.strings}=await n(this.hostElement,s("."))),this.modelChange(this.model),this.onModelConfigChange()}disconnectedCallback(){this.removeSeriesPopover(),this.model.removeEventListener("arcgisChartsModelConfigChange",this.onModelConfigChange)}buildSeriesListItems(){const t=this.model.getSeriesLength(),i=[];for(let s=0;s<t;s+=1){const a=this.model.getSeriesId(s),h=this.model.getSeriesColor(s),c=this.model.getSeriesName(s),l=this.model.getChartSubType()===u.BarAndLineFromFields?this.strings.series:a,n=this.model.getSeriesLineStyle(s),r=S(n);let o="#CCCCCC",d="minus-circle";if((t>1||!this.activeColorMatch)&&void 0!==h){d=`line-${r}`;const[t,i,s,e]=[...h];o=`rgba(${t},${i},${s},${e/255})`}i.push(e("calcite-list-item",{key:a,label:c??a??"",description:l,value:a,selected:this.selectedSeriesIndex===s,onClick:this.openSeriesPopOver},e("calcite-icon",{slot:"content-end",icon:d,style:{color:o}})))}return i}buildSeriesList(){return e("calcite-list",{label:"",dragEnabled:!0,selectionMode:"single",selectionAppearance:"border",onCalciteListOrderChange:this.onCalciteListOrderChange},this.buildSeriesListItems())}async componentWillRender(){this.isResetAvailable=await this.model.resetAvailable()}render(){return e(a,{key:"10ea150c44b98f9f5a5f8431b8461eafcc26182b"},e("calcite-panel",{key:"964f2b000510d2938b33a54dbe6441270b0e74c0",heading:this.strings.series},e("calcite-button",{key:"25c4f310b15036faea7bc08f9ff830fdba49c08d",slot:"header-actions-end",onClick:this.resetSeriesOriginal,disabled:!this.isResetAvailable,appearance:"transparent",scale:"s",iconEnd:"reset"},this.strings.reset),this.buildSeriesList()))}setupSeriesPopover(){null===this.seriesPopover&&void 0!==this.hostElement&&(this.seriesPopover=f(g.LineChartSeriesPopover,{referenceElement:this.hostElement,placement:this.popoverPlacement,seriesNameChange:this.seriesNameChange,seriesColorChange:this.seriesColorChange,seriesLineStyleChange:this.seriesLineStyleChange,seriesLineWidthChange:this.seriesLineWidthChange,openChange:this.openChange,popoverClose:this.seriesPopoverClose}))}addSeriesPopover(){null==this.seriesPopover||document.body.contains(this.seriesPopover)||document.body.appendChild(this.seriesPopover),this.seriesPopoverChange(!0)}static get assetsDirs(){return["assets"]}get hostElement(){return h(this)}static get watchers(){return{model:["modelChange"],selectedSeriesIndex:["selectedSeriesIndexChange"]}}};_.style=":host{display:flex;flex-direction:column;width:var(--arcgis-charts-config-calcite-block-default-width);margin:var(--arcgis-charts-config-calcite-block-default-margin)}";export{L as arcgis_charts_config_line_chart_data,_ as arcgis_charts_config_line_chart_series}