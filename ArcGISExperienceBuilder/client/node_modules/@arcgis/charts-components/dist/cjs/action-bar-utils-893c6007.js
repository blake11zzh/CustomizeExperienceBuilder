/*!
 * All material copyright ESRI, All Rights Reserved, unless otherwise specified.
 * See LICENSE.md for details.
 * v4.32.1
 */
'use strict';

const restJsObjectLiterals = require('./rest-js-object-literals-acb59afb.js');
const chartObjectLiterals = require('./chart-object-literals-a706ca0f.js');

const BarChartActions = [
    restJsObjectLiterals.Vy.EditChart,
    restJsObjectLiterals.Vy.Legend,
    restJsObjectLiterals.Vy.RotateChart,
    restJsObjectLiterals.Vy.FilterBySelection,
    restJsObjectLiterals.Vy.FilterByExtent,
    restJsObjectLiterals.Vy.Zoom,
    restJsObjectLiterals.Vy.Selection,
    restJsObjectLiterals.Vy.ClearSelection,
    restJsObjectLiterals.Vy.FullExtent,
    restJsObjectLiterals.Vy.SwitchSelection,
];
const LineChartActions = [
    restJsObjectLiterals.Vy.EditChart,
    restJsObjectLiterals.Vy.Legend,
    restJsObjectLiterals.Vy.RotateChart,
    restJsObjectLiterals.Vy.FilterBySelection,
    restJsObjectLiterals.Vy.FilterByExtent,
    restJsObjectLiterals.Vy.Zoom,
    restJsObjectLiterals.Vy.Selection,
    restJsObjectLiterals.Vy.ClearSelection,
    restJsObjectLiterals.Vy.FullExtent,
    restJsObjectLiterals.Vy.SwitchSelection,
];
const PieChartActions = [
    restJsObjectLiterals.Vy.EditChart,
    restJsObjectLiterals.Vy.Legend,
    restJsObjectLiterals.Vy.FilterBySelection,
    restJsObjectLiterals.Vy.FilterByExtent,
    restJsObjectLiterals.Vy.Selection,
    restJsObjectLiterals.Vy.ClearSelection,
    restJsObjectLiterals.Vy.SwitchSelection,
];
const HistogramActions = [
    restJsObjectLiterals.Vy.EditChart,
    restJsObjectLiterals.Vy.Legend,
    restJsObjectLiterals.Vy.FilterBySelection,
    restJsObjectLiterals.Vy.FilterByExtent,
    restJsObjectLiterals.Vy.Zoom,
    restJsObjectLiterals.Vy.Selection,
    restJsObjectLiterals.Vy.ClearSelection,
    restJsObjectLiterals.Vy.FullExtent,
    restJsObjectLiterals.Vy.SwitchSelection,
];
const ScatterPlotActions = [
    restJsObjectLiterals.Vy.EditChart,
    restJsObjectLiterals.Vy.Legend,
    restJsObjectLiterals.Vy.FilterBySelection,
    restJsObjectLiterals.Vy.FilterByExtent,
    restJsObjectLiterals.Vy.Zoom,
    restJsObjectLiterals.Vy.Selection,
    restJsObjectLiterals.Vy.ClearSelection,
    restJsObjectLiterals.Vy.FullExtent,
    restJsObjectLiterals.Vy.SwitchSelection,
];
const BoxPlotActions = [
    restJsObjectLiterals.Vy.EditChart,
    restJsObjectLiterals.Vy.Legend,
    restJsObjectLiterals.Vy.RotateChart,
    restJsObjectLiterals.Vy.FilterBySelection,
    restJsObjectLiterals.Vy.FilterByExtent,
    restJsObjectLiterals.Vy.Zoom,
    restJsObjectLiterals.Vy.Selection,
    restJsObjectLiterals.Vy.ClearSelection,
    restJsObjectLiterals.Vy.FullExtent,
    restJsObjectLiterals.Vy.SwitchSelection,
];
const GaugeActions = [restJsObjectLiterals.Vy.EditChart, restJsObjectLiterals.Vy.FilterByExtent];
/**
 * Returns the default actions for a given chart type
 * @param {ChartTypes} chartType The chart type for which to get the default actions
 * @returns {DefaultChartActions[]} The default actions for the given chart type
 */
function getDefaultChartActions(chartType) {
    switch (chartType) {
        case chartObjectLiterals.WebChartTypes.BarSeries:
            return BarChartActions;
        case chartObjectLiterals.WebChartTypes.LineSeries:
            return LineChartActions;
        case chartObjectLiterals.WebChartTypes.PieSeries:
            return PieChartActions;
        case chartObjectLiterals.WebChartTypes.HistogramSeries:
            return HistogramActions;
        case chartObjectLiterals.WebChartTypes.ScatterSeries:
            return ScatterPlotActions;
        case chartObjectLiterals.WebChartTypes.BoxPlotSeries:
            return BoxPlotActions;
        case chartObjectLiterals.WebChartTypes.GaugeSeries:
            return GaugeActions;
        default:
            return [];
    }
}
/**
 * Creates a new tooltip object and adds it to the DOM
 * @param innerHTML HTML to be displayed inside tooltip
 * @param referenceElement Element for which the tooltip will be shown
 * @returns The tooltip object that was created
 */
function createTooltip(innerHTML, referenceElement) {
    const tooltip = document.createElement("calcite-tooltip");
    tooltip.innerHTML = innerHTML;
    tooltip.style.setProperty("opacity", "1");
    if (referenceElement !== undefined) {
        tooltip.referenceElement = referenceElement;
    }
    document.body.appendChild(tooltip);
    return tooltip;
}
/**
 * Destroys tooltip by removing it from the DOM
 * @param tooltip The tooltip to be destroyed
 * @returns Null return for caller to easily reset tooltip object to null
 */
function destroyTooltip(tooltip) {
    tooltip?.remove();
    return null;
}
/**
 * Event handler for action bar slot change.
 * @param e
 * @param layer
 */
const onActionBarSlotChange = (e, chartComponent, config) => {
    // when the slot element changes, we add the event listener to the new slot element
    const actionBarSlot = e.target;
    const actionBar = actionBarSlot
        .assignedNodes()
        .find((node) => "legendToggle" in node);
    const chartType = restJsObjectLiterals.fl(config?.series);
    if (actionBar) {
        actionBar.chartType = chartType;
        updateActionBarStates(actionBar, chartComponent, config);
    }
};
/**
 * Updates the action bar states based on the properties of the chart component and the config object.
 * @param actionBar
 * @param chartComponent
 * @param config
 */
function updateActionBarStates(actionBar, chartComponent, config) {
    const selectionIsEmpty = restJsObjectLiterals.$l(chartComponent.selectionData);
    // This logic makes it so that an undefined legend is treated as not visible, but a defined legend with an undefined visible property is treated as visible to honor the ac-js default behavior.
    const configLegendVisible = config?.legend ? (config.legend.visible ?? true) : false;
    // Update the chart type on the action bar to determine which actions are shown
    actionBar.chartType = restJsObjectLiterals.fl(config?.series);
    // Edit chart action is shown if the chart component has configuration enabled
    if (chartComponent.enableConfiguration) {
        const currentHiddenActions = actionBar.hiddenActions ?? [];
        actionBar.hiddenActions = currentHiddenActions.filter((action) => action !== restJsObjectLiterals.Vy.EditChart);
    }
    // Edit chart action is enabled if the chart component has configuration enabled
    actionBar.editChartState = chartComponent.enableConfiguration ? restJsObjectLiterals.Gy.Enabled : restJsObjectLiterals.Gy.Disabled;
    // Legend action is enabled if the chart has a config which can show a legend
    const legendEnabled = config && restJsObjectLiterals.El(config.series);
    actionBar.legendState = legendEnabled ? restJsObjectLiterals.Gy.Enabled : restJsObjectLiterals.Gy.Disabled;
    // Legend toggle is active if the chart component has legend visibility set to true or if the config legend is visible
    actionBar.legendToggle =
        legendEnabled && (chartComponent.legendVisibility ?? configLegendVisible)
            ? restJsObjectLiterals.Uy.Active
            : restJsObjectLiterals.Uy.Inactive;
    // Rotate chart toggle is active if the chart component rotation is true or if the config rotation is true
    actionBar.rotateChartToggle =
        (chartComponent.rotation ?? config?.rotated) === true ? restJsObjectLiterals.Uy.Active : restJsObjectLiterals.Uy.Inactive;
    // Filter by selection action is enabled if either:
    // - The chart component is filtering by selection (because the user needs to be able to turn it off)
    // - Selection data is not empty and the chart component is not filtering by extent
    actionBar.filterBySelectionState =
        chartComponent.filterBySelection === true || (!selectionIsEmpty && chartComponent.filterByExtent !== true)
            ? restJsObjectLiterals.Gy.Enabled
            : restJsObjectLiterals.Gy.Disabled;
    // Filter by selection toggle is active if the chart component is filtering by selection
    actionBar.filterBySelectionToggle =
        chartComponent.filterBySelection === true ? restJsObjectLiterals.Uy.Active : restJsObjectLiterals.Uy.Inactive;
    // Filter by extent action is enabled if either:
    // - The chart component is filtering by extent (because the user needs to be able to turn it off)
    // - The chart component is not filtering by selection
    actionBar.filterByExtentState =
        chartComponent.filterByExtent === true || chartComponent.filterBySelection !== true
            ? restJsObjectLiterals.Gy.Enabled
            : restJsObjectLiterals.Gy.Disabled;
    // Filter by extent toggle is active if the chart component is filtering by extent
    actionBar.filterByExtentToggle = chartComponent.filterByExtent === true ? restJsObjectLiterals.Uy.Active : restJsObjectLiterals.Uy.Inactive;
    // Zoom action is enabled if the chart component is not filtering by selection
    actionBar.zoomState = !chartComponent.filterBySelection ? restJsObjectLiterals.Gy.Enabled : restJsObjectLiterals.Gy.Disabled;
    // Zoom toggle is active if the chart component is in zoom mode
    actionBar.zoomToggle = chartComponent.actionMode === restJsObjectLiterals.zy.Zoom ? restJsObjectLiterals.Uy.Active : restJsObjectLiterals.Uy.Inactive;
    // Selection action is enabled if the chart component is not filtering by selection
    actionBar.selectionState = !chartComponent.filterBySelection ? restJsObjectLiterals.Gy.Enabled : restJsObjectLiterals.Gy.Disabled;
    // Selection toggle is active if the chart component is in selection mode (undefined defaults to selection mode also)
    actionBar.selectionToggle =
        (chartComponent.actionMode ?? actionBar.actionBarSelectionMode) === actionBar.actionBarSelectionMode
            ? restJsObjectLiterals.Uy.Active
            : restJsObjectLiterals.Uy.Inactive;
    // Clear selection action is enabled if selection data is not empty
    actionBar.clearSelectionState = !selectionIsEmpty ? restJsObjectLiterals.Gy.Enabled : restJsObjectLiterals.Gy.Disabled;
    // Full extent action is enabled if the chart component is not filtering by selection
    actionBar.fullExtentState = !chartComponent.filterBySelection ? restJsObjectLiterals.Gy.Enabled : restJsObjectLiterals.Gy.Disabled;
    // Switch selection action is enabled if the chart component is not filtering by selection
    actionBar.switchSelectionState = !chartComponent.filterBySelection ? restJsObjectLiterals.Gy.Enabled : restJsObjectLiterals.Gy.Disabled;
}

exports.createTooltip = createTooltip;
exports.destroyTooltip = destroyTooltip;
exports.getDefaultChartActions = getDefaultChartActions;
exports.onActionBarSlotChange = onActionBarSlotChange;
exports.updateActionBarStates = updateActionBarStates;
